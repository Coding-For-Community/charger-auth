import{e as kn,T as In,U as Ir,r as vt,j as J,a as wt}from"./index-BVkeMsIk.js";import{S as Ur}from"./Stack-FmZhMklb.js";import{G as Lr}from"./Group-SOfAlG9n.js";import{T as Kt}from"./Title-B_1i9yON.js";import{B as Qt}from"./Button-D8mXHvB5.js";import{C as Pr}from"./Card-BFGUiukp.js";import{T as _t}from"./Text-C0IyE6Ld.js";import{M as Br}from"./Modal-CN6AvZWg.js";import"./polymorphic-factory-Dsjmfy3G.js";import"./perms-VmazJKA4.js";import"./fetchBackend-CVLyjmH-.js";import"./UnstyledButton-nbL01KvM.js";import"./Paper-C6JxnMY6.js";import"./FocusTrap-Cpap6mhz.js";import"./CloseButton-DsaY2qvx.js";import"./icons-DPll1qNE.js";var we={};const xr=e=>t=>{const n=e(t);return t.add(n),n},Dr=e=>(t,n)=>(e.set(t,n),n),Jt=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Un=536870912,en=Un*2,Wr=(e,t)=>n=>{const r=t.get(n);let o=r===void 0?n.size:r<en?r+1:0;if(!n.has(o))return e(n,o);if(n.size<Un){for(;n.has(o);)o=Math.floor(Math.random()*en);return e(n,o)}if(n.size>Jt)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(o);)o=Math.floor(Math.random()*Jt);return e(n,o)},Ln=new WeakMap,Vr=Dr(Ln),Pn=Wr(Vr,Ln),jr=xr(Pn),Fr=e=>typeof e.start=="function",tn=new WeakMap,$r=e=>({...e,connect:({call:t})=>async()=>{const{port1:n,port2:r}=new MessageChannel,o=await t("connect",{port:n},[n]);return tn.set(r,o),r},disconnect:({call:t})=>async n=>{const r=tn.get(n);if(r===void 0)throw new Error("The given port is not connected.");await t("disconnect",{portId:r})},isSupported:({call:t})=>()=>t("isSupported")}),yt=new WeakMap,qr=e=>{if(yt.has(e))return yt.get(e);const t=new Map;return yt.set(e,t),t},Bn=e=>{const t=$r(e);return n=>{const r=qr(n);n.addEventListener("message",(({data:c})=>{const{id:i}=c;if(i!==null&&r.has(i)){const{reject:u,resolve:d}=r.get(i);r.delete(i),c.error===void 0?d(c.result):u(new Error(c.error.message))}})),Fr(n)&&n.start();const o=(c,i=null,u=[])=>new Promise((d,l)=>{const h=Pn(r);r.set(h,{reject:l,resolve:d}),i===null?n.postMessage({id:h,method:c},u):n.postMessage({id:h,method:c,params:i},u)}),s=(c,i,u=[])=>{n.postMessage({id:null,method:c,params:i},u)};let a={};for(const[c,i]of Object.entries(t))a={...a,[c]:i({call:o,notify:s})};return{...a}}},nn=new Set,Gr=Bn({deregister:({call:e})=>t=>e("deregister",{port:t},[t]),encode:({call:e})=>async(t,n)=>{const r=await e("encode",{encoderId:t,timeslice:n});return nn.delete(t),r},instantiate:({call:e})=>async(t,n)=>{const r=jr(nn),o=await e("instantiate",{encoderId:r,mimeType:t,sampleRate:n});return{encoderId:r,port:o}},register:({call:e})=>t=>e("register",{port:t},[t])}),zr=e=>{const t=new Worker(e);return Gr(t)},Xr=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),l=a(c,i),d=t(l);e.addUniqueNumber=d,e.generateUniqueNumber=l}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";var e=r(455);const t=new WeakMap,n=new WeakMap,o=(r=>{const o=(s=r,{...s,connect:e=>{let{call:r}=e;return async()=>{const{port1:e,port2:n}=new MessageChannel,o=await r("connect",{port:e},[e]);return t.set(n,o),n}},disconnect:e=>{let{call:r}=e;return async e=>{const n=t.get(e);if(void 0===n)throw new Error("The given port is not connected.");await r("disconnect",{portId:n})}},isSupported:e=>{let{call:t}=e;return()=>t("isSupported")}});var s;return t=>{const r=(e=>{if(n.has(e))return n.get(e);const t=new Map;return n.set(e,t),t})(t);t.addEventListener("message",(e=>{let{data:t}=e;const{id:n}=t;if(null!==n&&r.has(n)){const{reject:e,resolve:o}=r.get(n);r.delete(n),void 0===t.error?o(t.result):e(new Error(t.error.message))}})),(e=>"function"==typeof e.start)(t)&&t.start();const s=function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return new Promise(((a,i)=>{const c=(0,e.generateUniqueNumber)(r);r.set(c,{reject:i,resolve:a}),null===o?t.postMessage({id:c,method:n},s):t.postMessage({id:c,method:n,params:o},s)}))},a=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];t.postMessage({id:null,method:e,params:r},n)};let i={};for(const[e,t]of Object.entries(o))i={...i,[e]:t({call:s,notify:a})};return{...i}}})({characterize:e=>{let{call:t}=e;return()=>t("characterize")},encode:e=>{let{call:t}=e;return(e,r)=>t("encode",{recordingId:e,timeslice:r})},record:e=>{let{call:t}=e;return async(e,r,n)=>{await t("record",{recordingId:e,sampleRate:r,typedArrays:n},n.map((e=>{let{buffer:t}=e;return t})))}}}),s=-32603,a=-32602,i=-32601,c=(e,t)=>Object.assign(new Error(e),{status:t}),l=e=>c('The handler of the method called "'.concat(e,'" returned an unexpected result.'),s),d=(e,t)=>async r=>{let{data:{id:n,method:o,params:a}}=r;const d=t[o];try{if(void 0===d)throw(e=>c('The requested method called "'.concat(e,'" is not supported.'),i))(o);const t=void 0===a?d():d(a);if(void 0===t)throw(e=>c('The handler of the method called "'.concat(e,'" returned no required result.'),s))(o);const r=t instanceof Promise?await t:t;if(null===n){if(void 0!==r.result)throw l(o)}else{if(void 0===r.result)throw l(o);const{result:t,transferables:s=[]}=r;e.postMessage({id:n,result:t},s)}}catch(t){const{message:r,status:o=-32603}=t;e.postMessage({error:{code:o,message:r},id:n})}},u=new Map,h=(t,r,n)=>({...r,connect:n=>{let{port:o}=n;o.start();const s=t(o,r),a=(0,e.generateUniqueNumber)(u);return u.set(a,(()=>{s(),o.close(),u.delete(a)})),{result:a}},disconnect:e=>{let{portId:t}=e;const r=u.get(t);if(void 0===r)throw(e=>c('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),a))(t);return r(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=t=>{let{data:r}=t;return e(null!==r)},n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),f=function(e,t){const r=h(f,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0),n=d(e,r);return e.addEventListener("message",n),()=>e.removeEventListener("message",n)},p=e=>{e.onmessage=null,e.close()},w=new Map,m=new WeakMap,g=((e,t)=>r=>{const n=t.get(r);if(void 0===n)throw new Error("There is no encoder stored which wraps this port.");e.delete(n),t.delete(r)})(w,m),v=new Map,y=(e=>t=>{const r=e.get(t);if(void 0===r)throw new Error("There was no instance of an encoder stored with the given id.");return r})(v),M=((e,t)=>r=>{const n=t(r);return e.delete(r),n})(v,y),E=((e,t)=>r=>{const[n,o,s,a]=t(r);return s?new Promise((t=>{o.onmessage=s=>{let{data:i}=s;0===i.length?(e(o),t(n.encode(r,null))):n.record(r,a,i)}})):n.encode(r,null)})(p,M),b=(e=>t=>{for(const[r,n]of Array.from(e.values()))if(r.test(t))return n;throw new Error("There is no encoder registered which could handle the given mimeType.")})(w),T=((e,t,r)=>(n,o,s)=>{if(t.has(n))throw new Error('There is already an encoder registered with an id called "'.concat(n,'".'));const a=r(o),{port1:i,port2:c}=new MessageChannel,l=[a,i,!0,s];return t.set(n,l),i.onmessage=t=>{let{data:r}=t;0===r.length?(e(i),l[2]=!1):a.record(n,s,r.map((e=>"number"==typeof e?new Float32Array(e):e)))},c})(p,v,b),I=((e,t,r)=>async n=>{const o=r(n),s=await o.characterize(),a=s.toString();if(e.has(a)||t.has(n))throw new Error("There is already an encoder stored which handles exactly the same mime types.");return e.set(a,[s,o]),t.set(n,a),s})(w,m,o),A=(e=>(t,r)=>{const[n]=e(t);return n.encode(t,r)})(y);f(self,{deregister:async e=>{let{port:t}=e;return{result:g(t)}},encode:async e=>{let{encoderId:t,timeslice:r}=e;const n=null===r?await E(t):await A(t,r);return{result:n,transferables:n}},instantiate:e=>{let{encoderId:t,mimeType:r,sampleRate:n}=e;const o=T(t,r,n);return{result:o,transferables:[o]}},register:async e=>{let{port:t}=e;return{result:await I(t)}}})})()})();`,Hr=new Blob([Xr],{type:"application/javascript; charset=utf-8"}),xn=URL.createObjectURL(Hr),Bt=zr(xn),Ke=Bt.encode,Dn=Bt.instantiate,Yr=Bt.register;URL.revokeObjectURL(xn);const Zr=e=>(t,n)=>{if(e===null){const{data:r,...o}=n,s=new Event(t,o);return s.data=r,s}return new e(t,n)},Kr=(e,t)=>(n,r,o)=>{const s=[];let a=r,c=0;for(;c<n.byteLength;)if(a===null){const i=t(n,c);if(i===null)break;const{length:u,type:d}=i;a=d,c+=u}else{const i=e(n,c,a,o);if(i===null)break;const{content:u,length:d}=i;a=null,c+=d,u!==null&&s.push(u)}return{contents:s,currentElementType:a,offset:c}},Qr=(e,t)=>class{constructor(r=null){this._listeners=new WeakMap,this._nativeEventTarget=r===null?e():r}addEventListener(r,o,s){if(o!==null){let a=this._listeners.get(o);a===void 0&&(a=t(this,o),typeof o=="function"&&this._listeners.set(o,a)),this._nativeEventTarget.addEventListener(r,a,s)}}dispatchEvent(r){return this._nativeEventTarget.dispatchEvent(r)}removeEventListener(r,o,s){const a=o===null?void 0:this._listeners.get(o);this._nativeEventTarget.removeEventListener(r,a===void 0?null:a,s)}},Jr=e=>()=>{if(e===null)throw new Error("A native EventTarget could not be created.");return e.document.createElement("p")},xt=(e="")=>{try{return new DOMException(e,"InvalidModificationError")}catch(t){return t.code=13,t.message=e,t.name="InvalidModificationError",t}},eo=()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}},to=e=>e!==null&&e.MediaStream!==void 0&&(e.MediaRecorder===void 0||e.MediaRecorder.isTypeSupported!==void 0)?new Promise(t=>{if(e.MediaRecorder===void 0)return t(!0);const n=document.createElement("canvas");if(n.getContext("2d"),typeof n.captureStream!="function")return t(!1);const r=n.captureStream(),o="audio/webm";try{const s=new e.MediaRecorder(r,{mimeType:o});s.addEventListener("dataavailable",({data:a})=>t(a.type===o)),s.start(),setTimeout(()=>s.stop(),10)}catch(s){t(s.name==="NotSupportedError")}}):Promise.resolve(!1),no=(e,t,n,r,o,s,a)=>class extends s{constructor(i,u={}){const{mimeType:d}=u;if(a!==null&&(d===void 0||a.isTypeSupported!==void 0&&a.isTypeSupported(d))){const l=e(a,i,u);super(l),this._internalMediaRecorder=l}else if(d!==void 0&&o.some(l=>l.test(d)))super(),a!==null&&a.isTypeSupported!==void 0&&a.isTypeSupported("audio/webm;codecs=pcm")?this._internalMediaRecorder=r(this,a,i,d):this._internalMediaRecorder=n(this,i,d);else throw a!==null&&e(a,i,u),t();this._ondataavailable=null,this._onerror=null,this._onpause=null,this._onresume=null,this._onstart=null,this._onstop=null}get mimeType(){return this._internalMediaRecorder.mimeType}get ondataavailable(){return this._ondataavailable===null?this._ondataavailable:this._ondataavailable[0]}set ondataavailable(i){if(this._ondataavailable!==null&&this.removeEventListener("dataavailable",this._ondataavailable[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("dataavailable",u),this._ondataavailable=[i,u]}else this._ondataavailable=null}get onerror(){return this._onerror===null?this._onerror:this._onerror[0]}set onerror(i){if(this._onerror!==null&&this.removeEventListener("error",this._onerror[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("error",u),this._onerror=[i,u]}else this._onerror=null}get onpause(){return this._onpause===null?this._onpause:this._onpause[0]}set onpause(i){if(this._onpause!==null&&this.removeEventListener("pause",this._onpause[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("pause",u),this._onpause=[i,u]}else this._onpause=null}get onresume(){return this._onresume===null?this._onresume:this._onresume[0]}set onresume(i){if(this._onresume!==null&&this.removeEventListener("resume",this._onresume[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("resume",u),this._onresume=[i,u]}else this._onresume=null}get onstart(){return this._onstart===null?this._onstart:this._onstart[0]}set onstart(i){if(this._onstart!==null&&this.removeEventListener("start",this._onstart[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("start",u),this._onstart=[i,u]}else this._onstart=null}get onstop(){return this._onstop===null?this._onstop:this._onstop[0]}set onstop(i){if(this._onstop!==null&&this.removeEventListener("stop",this._onstop[1]),typeof i=="function"){const u=i.bind(this);this.addEventListener("stop",u),this._onstop=[i,u]}else this._onstop=null}get state(){return this._internalMediaRecorder.state}pause(){return this._internalMediaRecorder.pause()}resume(){return this._internalMediaRecorder.resume()}start(i){return this._internalMediaRecorder.start(i)}stop(){return this._internalMediaRecorder.stop()}static isTypeSupported(i){return a!==null&&a.isTypeSupported!==void 0&&a.isTypeSupported(i)||o.some(u=>u.test(i))}},ro=e=>e!==null&&e.BlobEvent!==void 0?e.BlobEvent:null,oo=(e,t)=>(n,r,o)=>{const s=[],a=new WeakMap,c=new WeakMap,i=new n(r,o),u=new WeakMap;let d=!0;return i.addEventListener=(l=>(h,m,f)=>{let p=m;return typeof m=="function"&&(h==="dataavailable"?(p=g=>{setTimeout(()=>{if(d&&i.state==="inactive")s.push(g.data);else{if(s.length>0){const v=g.data;Object.defineProperty(g,"data",{value:new Blob([...s,v],{type:v.type})}),s.length=0}m.call(i,g)}})},a.set(m,p)):h==="error"?(p=g=>{if(g.error===void 0)m.call(i,new ErrorEvent("error",{error:e()}));else if(g.error.name==="UnknownError"){const v=g.error.message;m.call(i,new ErrorEvent("error",{error:e(v)}))}else g instanceof ErrorEvent?m.call(i,g):m.call(i,new ErrorEvent("error",{error:g.error}))},c.set(m,p)):h==="stop"&&(p=g=>{d=!1,setTimeout(()=>m.call(i,g))},u.set(m,p))),l.call(i,h,p,f)})(i.addEventListener),i.dispatchEvent=(l=>h=>{let m;setTimeout(()=>{m=d,d=!1});const f=l.call(i,h);return setTimeout(()=>d=m),f})(i.dispatchEvent),i.removeEventListener=(l=>(h,m,f)=>{let p=m;if(typeof m=="function"){if(h==="dataavailable"){const g=a.get(m);g!==void 0&&(p=g)}else if(h==="error"){const g=c.get(m);g!==void 0&&(p=g)}else if(h==="stop"){const g=u.get(m);g!==void 0&&(p=g)}}return l.call(i,h,p,f)})(i.removeEventListener),i.start=(l=>h=>{if(o.mimeType!==void 0&&o.mimeType.startsWith("audio/")&&r.getVideoTracks().length>0)throw t();return d=h!==void 0,h===void 0?l.call(i):l.call(i,h)})(i.start),i},so=e=>e===null||e.MediaRecorder===void 0?null:e.MediaRecorder,ot=()=>{try{return new DOMException("","NotSupportedError")}catch(e){return e.code=9,e.name="NotSupportedError",e}},ao=e=>(t,n,r,o=2)=>{const s=e(t,n);if(s===null)return s;const{length:a,value:c}=s;if(r==="master")return{content:null,length:a};if(n+a+c>t.byteLength)return null;if(r==="binary"){const i=(c/Float32Array.BYTES_PER_ELEMENT-1)/o,u=Array.from({length:o},()=>new Float32Array(i));for(let d=0;d<i;d+=1){const l=d*o+1;for(let h=0;h<o;h+=1)u[h][d]=t.getFloat32(n+a+(l+h)*Float32Array.BYTES_PER_ELEMENT,!0)}return{content:u,length:a+c}}return{content:null,length:a+c}},io=e=>(t,n)=>{const r=e(t,n);if(r===null)return r;const{length:o,value:s}=r;return s===35?{length:o,type:"binary"}:s===46||s===97||s===88713574||s===106212971||s===139690087||s===172351395||s===256095861?{length:o,type:"master"}:{length:o,type:"unknown"}},co=e=>(t,n)=>{const r=e(t,n);if(r===null)return r;const o=n+Math.floor((r-1)/8);if(o+r>t.byteLength)return null;let a=t.getUint8(o)&(1<<8-r%8)-1;for(let c=1;c<r;c+=1)a=(a<<8)+t.getUint8(o+c);return{length:r,value:a}},uo=e=>(t,n)=>(e.set(t,n),n),rn=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Wn=536870912,on=Wn*2,lo=(e,t)=>n=>{const r=t.get(n);let o=r===void 0?n.size:r<on?r+1:0;if(!n.has(o))return e(n,o);if(n.size<Wn){for(;n.has(o);)o=Math.floor(Math.random()*on);return e(n,o)}if(n.size>rn)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(o);)o=Math.floor(Math.random()*rn);return e(n,o)},Vn=new WeakMap,fo=uo(Vn),ho=lo(fo,Vn),sn=Symbol.observable||"@@observable";function po(e){return Symbol.observable||(typeof e=="function"&&e.prototype&&e.prototype[Symbol.observable]?(e.prototype[sn]=e.prototype[Symbol.observable],delete e.prototype[Symbol.observable]):(e[sn]=e[Symbol.observable],delete e[Symbol.observable])),e}const Xe=()=>{},an=e=>{throw e};function mo(e){return e?e.next&&e.error&&e.complete?e:{complete:(e.complete??Xe).bind(e),error:(e.error??an).bind(e),next:(e.next??Xe).bind(e)}:{complete:Xe,error:an,next:Xe}}const go=e=>(t,n,r)=>e(o=>{const s=a=>o.next(a);return t.addEventListener(n,s,r),()=>t.removeEventListener(n,s,r)}),vo=(e,t)=>{const n=()=>{},r=o=>typeof o[0]=="function";return o=>{const s=((...a)=>{const c=o(r(a)?t({next:a[0]}):t(...a));return c!==void 0?c:n});return s[Symbol.observable]=()=>({subscribe:(...a)=>({unsubscribe:s(...a)})}),e(s)}},wo=vo(po,mo),jn=go(wo);/*!
 * dashify <https://github.com/jonschlinkert/dashify>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var Et,cn;function _o(){return cn||(cn=1,Et=(e,t)=>{if(typeof e!="string")throw new TypeError("expected a string");return e.trim().replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\W/g,n=>/[À-ž]/.test(n)?n:"-").replace(/^-+|-+$/g,"").replace(/-{2,}/g,n=>t&&t.condense?"-":n).toLowerCase()}),Et}var yo=_o();const Eo=kn(yo);var bt={exports:{}},un;function bo(){return un||(un=1,(function(e){var t=function(n){var r,o,s=/\w+/.exec(n);if(s)o=s[0];else return"an";var a=o.toLowerCase(),c=["honest","hour","hono"];for(r in c)if(a.indexOf(c[r])==0)return"an";if(a.length==1)return"aedhilmnorsx".indexOf(a)>=0?"an":"a";if(o.match(/(?!FJO|[HLMNS]Y.|RY[EO]|SQU|(F[LR]?|[HL]|MN?|N|RH?|S[CHKLMNPTVW]?|X(YL)?)[AEIOU])[FHLMNRSX][A-Z]/))return"an";var i=[/^e[uw]/,/^onc?e\b/,/^uni([^nmd]|mo)/,/^u[bcfhjkqrst][aeiou]/];for(r=0;r<i.length;r++)if(a.match(i[r]))return"a";return o.match(/^U[NK][AIEO]/)?"a":o==o.toUpperCase()?"aedhilmnorsx".indexOf(a[0])>=0?"an":"a":"aeiou".indexOf(a[0])>=0||a.match(/^y(b[lor]|cl[ea]|fere|gg|p[ios]|rou|tt)/)?"an":"a"};e.exports=t})(bt)),bt.exports}var Ao=bo();const To=kn(Ao),ln=(e,t)=>t===void 0?e:t.reduce((n,r)=>{if(r==="capitalize"){const o=n.charAt(0).toUpperCase(),s=n.slice(1);return`${o}${s}`}return r==="dashify"?Eo(n):r==="prependIndefiniteArticle"?`${To(n)} ${n}`:n},e),Co=e=>{const t=e.name+e.modifiers.map(n=>`\\.${n}\\(\\)`).join("");return new RegExp(`\\$\\{${t}}`,"g")},dn=(e,t)=>{const n=/\${([^.}]+)((\.[^(]+\(\))*)}/g,r=[];let o=n.exec(e);for(;o!==null;){const a={modifiers:[],name:o[1]};if(o[3]!==void 0){const c=/\.[^(]+\(\)/g;let i=c.exec(o[2]);for(;i!==null;)a.modifiers.push(i[0].slice(1,-2)),i=c.exec(o[2])}r.push(a),o=n.exec(e)}const s=r.reduce((a,c)=>a.map(i=>typeof i=="string"?i.split(Co(c)).reduce((u,d,l)=>l===0?[d]:c.name in t?[...u,ln(t[c.name],c.modifiers),d]:[...u,h=>ln(h[c.name],c.modifiers),d],[]):[i]).reduce((i,u)=>[...i,...u],[]),[e]);return a=>s.reduce((c,i)=>typeof i=="string"?[...c,i]:[...c,i(a)],[]).join("")},st=(e,t={})=>{const n=e.code===void 0?void 0:dn(e.code,t),r=e.message===void 0?void 0:dn(e.message,t);function o(s={},a){const c=a===void 0&&(s instanceof Error||s.code!==void 0&&s.code.slice(-9)==="Exception"),{cause:i,missingParameters:u}=c?{cause:s,missingParameters:{}}:{cause:a,missingParameters:s},d=r===void 0?new Error:new Error(r(u));return i!==null&&(d.cause=i),n!==void 0&&(d.code=n(u)),e.status!==void 0&&(d.status=e.status),d}return o},at={INTERNAL_ERROR:-32603,INVALID_PARAMS:-32602,METHOD_NOT_FOUND:-32601};st({message:'The requested method called "${method}" is not supported.',status:at.METHOD_NOT_FOUND});st({message:'The handler of the method called "${method}" returned no required result.',status:at.INTERNAL_ERROR});st({message:'The handler of the method called "${method}" returned an unexpected result.',status:at.INTERNAL_ERROR});st({message:'The specified parameter called "portId" with the given value "${portId}" does not identify a port connected to this worker.',status:at.INVALID_PARAMS});const Mo=(e,t,n)=>async r=>{const o=new e([n],{type:"application/javascript; charset=utf-8"}),s=t.createObjectURL(o);try{await r(s)}finally{t.revokeObjectURL(s)}},No=e=>({data:t})=>{const{id:n}=t;if(n!==null){const r=e.get(n);if(r!==void 0){const{reject:o,resolve:s}=r;e.delete(n),t.error===void 0?s(t.result):o(new Error(t.error.message))}}},Ro=e=>(t,n)=>(r,o=[])=>new Promise((s,a)=>{const c=e(t);t.set(c,{reject:a,resolve:s}),n.postMessage({id:c,...r},o)}),So=(e,t,n,r)=>(o,s,a={})=>{const c=new o(s,"recorder-audio-worklet-processor",{...a,channelCountMode:"explicit",numberOfInputs:1,numberOfOutputs:0}),i=new Map,u=t(i,c.port),d=n(c.port,"message")(e(i));c.port.start();let l="inactive";return Object.defineProperties(c,{pause:{get(){return async()=>(r(["recording"],l),l="paused",u({method:"pause"}))}},port:{get(){throw new Error("The port of a RecorderAudioWorkletNode can't be accessed.")}},record:{get(){return async h=>(r(["inactive"],l),l="recording",u({method:"record",params:{encoderPort:h}},[h]))}},resume:{get(){return async()=>(r(["paused"],l),l="recording",u({method:"resume"}))}},stop:{get(){return async()=>{r(["paused","recording"],l),l="stopped";try{await u({method:"stop"})}finally{d()}}}}}),c},Oo=(e,t)=>{if(!e.includes(t))throw new Error(`Expected the state to be ${e.map(n=>`"${n}"`).join(" or ")} but it was "${t}".`)},ko='(()=>{"use strict";class e extends AudioWorkletProcessor{constructor(){super(),this._encoderPort=null,this._state="inactive",this.port.onmessage=e=>{let{data:t}=e;"pause"===t.method?"active"===this._state||"recording"===this._state?(this._state="paused",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"record"===t.method?"inactive"===this._state?(this._encoderPort=t.params.encoderPort,this._state="active",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"resume"===t.method?"paused"===this._state?(this._state="active",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"stop"===t.method?"active"!==this._state&&"paused"!==this._state&&"recording"!==this._state||null===this._encoderPort?this._sendUnexpectedStateError(t.id):(this._stop(this._encoderPort),this._sendAcknowledgement(t.id)):"number"==typeof t.id&&this.port.postMessage({error:{code:-32601,message:"The requested method is not supported."},id:t.id})}}process(e){let[t]=e;if("inactive"===this._state||"paused"===this._state)return!0;if("active"===this._state){if(void 0===t)throw new Error("No channelData was received for the first input.");if(0===t.length)return!0;this._state="recording"}if("recording"===this._state&&null!==this._encoderPort){if(void 0===t)throw new Error("No channelData was received for the first input.");if(0!==t.length)return this._encoderPort.postMessage(t,t.map((e=>{let{buffer:t}=e;return t}))),!0;this._stop(this._encoderPort)}return!1}_sendAcknowledgement(e){this.port.postMessage({id:e,result:null})}_sendUnexpectedStateError(e){this.port.postMessage({error:{code:-32603,message:"The internal state does not allow to process the given message."},id:e})}_stop(e){e.postMessage([]),e.close(),this._encoderPort=null,this._state="stopped"}}e.parameterDescriptors=[],registerProcessor("recorder-audio-worklet-processor",e)})();',Io=Mo(Blob,URL,ko),Uo=So(No,Ro(ho),jn,Oo),fn=(e,t,n)=>({endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}),hn=(e,t,n)=>({endTime:t,insertTime:n,type:"linearRampToValue",value:e}),Mt=(e,t)=>({startTime:t,type:"setValue",value:e}),Fn=(e,t,n)=>({duration:n,startTime:t,type:"setValueCurve",values:e}),$n=(e,t,{startTime:n,target:r,timeConstant:o})=>r+(t-r)*Math.exp((n-e)/o),Re=e=>e.type==="exponentialRampToValue",Qe=e=>e.type==="linearRampToValue",he=e=>Re(e)||Qe(e),Dt=e=>e.type==="setValue",ce=e=>e.type==="setValueCurve",Je=(e,t,n,r)=>{const o=e[t];return o===void 0?r:he(o)||Dt(o)?o.value:ce(o)?o.values[o.values.length-1]:$n(n,Je(e,t-1,o.startTime,r),o)},pn=(e,t,n,r,o)=>n===void 0?[r.insertTime,o]:he(n)?[n.endTime,n.value]:Dt(n)?[n.startTime,n.value]:ce(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Je(e,t-1,n.startTime,o)],Nt=e=>e.type==="cancelAndHold",Rt=e=>e.type==="cancelScheduledValues",fe=e=>Nt(e)||Rt(e)?e.cancelTime:Re(e)||Qe(e)?e.endTime:e.startTime,mn=(e,t,n,{endTime:r,value:o})=>n===o?o:0<n&&0<o||n<0&&o<0?n*(o/n)**((e-t)/(r-t)):0,gn=(e,t,n,{endTime:r,value:o})=>n+(e-t)/(r-t)*(o-n),Lo=(e,t)=>{const n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},Po=(e,{duration:t,startTime:n,values:r})=>{const o=(e-n)/t*(r.length-1);return Lo(r,o)},He=e=>e.type==="setTarget";class Bo{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const n=fe(t);if(Nt(t)||Rt(t)){const r=this._automationEvents.findIndex(s=>Rt(t)&&ce(s)?s.startTime+s.duration>=n:fe(s)>=n),o=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),Nt(t)){const s=this._automationEvents[this._automationEvents.length-1];if(o!==void 0&&he(o)){if(s!==void 0&&He(s))throw new Error("The internal list is malformed.");const a=s===void 0?o.insertTime:ce(s)?s.startTime+s.duration:fe(s),c=s===void 0?this._defaultValue:ce(s)?s.values[s.values.length-1]:s.value,i=Re(o)?mn(n,a,c,o):gn(n,a,c,o),u=Re(o)?fn(i,n,this._currenTime):hn(i,n,this._currenTime);this._automationEvents.push(u)}if(s!==void 0&&He(s)&&this._automationEvents.push(Mt(this.getValue(n),n)),s!==void 0&&ce(s)&&s.startTime+s.duration>n){const a=n-s.startTime,c=(s.values.length-1)/s.duration,i=Math.max(2,1+Math.ceil(a*c)),u=a/(i-1)*c,d=s.values.slice(0,i);if(u<1)for(let l=1;l<i;l+=1){const h=u*l%1;d[l]=s.values[l-1]*(1-h)+s.values[l]*h}this._automationEvents[this._automationEvents.length-1]=Fn(d,s.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>fe(a)>n),o=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(o!==void 0&&ce(o)&&fe(o)+o.duration>n)return!1;const s=Re(t)?fn(t.value,t.endTime,this._currenTime):Qe(t)?hn(t.value,n,this._currenTime):t;if(r===-1)this._automationEvents.push(s);else{if(ce(t)&&n+t.duration>fe(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(t){const n=this._automationEvents.findIndex(r=>fe(r)>t);if(n>1){const r=this._automationEvents.slice(n-1),o=r[0];He(o)&&r.unshift(Mt(Je(this._automationEvents,n-2,o.startTime,this._defaultValue),o.startTime)),this._automationEvents=r}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(a=>fe(a)>t),r=this._automationEvents[n],o=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[o];if(s!==void 0&&He(s)&&(r===void 0||!he(r)||r.insertTime>t))return $n(t,Je(this._automationEvents,o-1,s.startTime,this._defaultValue),s);if(s!==void 0&&Dt(s)&&(r===void 0||!he(r)))return s.value;if(s!==void 0&&ce(s)&&(r===void 0||!he(r)||s.startTime+s.duration>t))return t<s.startTime+s.duration?Po(t,s):s.values[s.values.length-1];if(s!==void 0&&he(s)&&(r===void 0||!he(r)))return s.value;if(r!==void 0&&Re(r)){const[a,c]=pn(this._automationEvents,o,s,r,this._defaultValue);return mn(t,a,c,r)}if(r!==void 0&&Qe(r)){const[a,c]=pn(this._automationEvents,o,s,r,this._defaultValue);return gn(t,a,c,r)}return this._defaultValue}}const xo=e=>({cancelTime:e,type:"cancelAndHold"}),Do=e=>({cancelTime:e,type:"cancelScheduledValues"}),Wo=(e,t)=>({endTime:t,type:"exponentialRampToValue",value:e}),Vo=(e,t)=>({endTime:t,type:"linearRampToValue",value:e}),jo=(e,t,n)=>({startTime:t,target:e,timeConstant:n,type:"setTarget"}),Fo=()=>new DOMException("","AbortError"),$o=e=>(t,n,[r,o,s],a)=>{e(t[o],[n,r,s],c=>c[0]===n&&c[1]===r,a)},qo=e=>(t,n,r)=>{const o=[];for(let s=0;s<r.numberOfInputs;s+=1)o.push(new Set);e.set(t,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},Go=e=>(t,n)=>{e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Se=new WeakSet,qn=new WeakMap,Gn=new WeakMap,zn=new WeakMap,Xn=new WeakMap,Hn=new WeakMap,Yn=new WeakMap,St=new WeakMap,Ot=new WeakMap,kt=new WeakMap,Zn={construct(){return Zn}},zo=e=>{try{const t=new Proxy(e,Zn);new t}catch{return!1}return!0},vn=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,wn=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),o=r.match(vn);for(;o!==null;){const s=o[1].slice(1,-1),a=o[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,t).toString());n.push(a),r=r.slice(o[0].length).replace(/^[\s]+/,""),o=r.match(vn)}return[n.join(";"),r]},_n=e=>{if(e!==void 0&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},yn=e=>{if(!zo(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(e.prototype===null||typeof e.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Xo=(e,t,n,r,o,s,a,c,i,u,d,l,h)=>{let m=0;return(f,p,g={credentials:"omit"})=>{const v=d.get(f);if(v!==void 0&&v.has(p))return Promise.resolve();const w=u.get(f);if(w!==void 0){const E=w.get(p);if(E!==void 0)return E}const _=s(f),M=_.audioWorklet===void 0?o(p).then(([E,A])=>{const[b,y]=wn(E,A),R=`${b};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${y}
})})(window,'_AWGS')`;return n(R)}).then(()=>{const E=h._AWGS.pop();if(E===void 0)throw new SyntaxError;r(_.currentTime,_.sampleRate,()=>E(class{},void 0,(A,b)=>{if(A.trim()==="")throw t();const y=Ot.get(_);if(y!==void 0){if(y.has(A))throw t();yn(b),_n(b.parameterDescriptors),y.set(A,b)}else yn(b),_n(b.parameterDescriptors),Ot.set(_,new Map([[A,b]]))},_.sampleRate,void 0,void 0))}):Promise.all([o(p),Promise.resolve(e(l,l))]).then(([[E,A],b])=>{const y=m+1;m=y;const[R,I]=wn(E,A),D=`${R};((AudioWorkletProcessor,registerProcessor)=>{${I}
})(${b?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${b?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${b?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${y}',class extends AudioWorkletProcessor{process(){return !1}})`,B=new Blob([D],{type:"application/javascript; charset=utf-8"}),U=URL.createObjectURL(B);return _.audioWorklet.addModule(U,g).then(()=>{if(c(_))return _;const x=a(_);return x.audioWorklet.addModule(U,g).then(()=>x)}).then(x=>{if(i===null)throw new SyntaxError;try{new i(x,`__sac${y}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(U))});return w===void 0?u.set(f,new Map([[p,M]])):w.set(p,M),M.then(()=>{const E=d.get(f);E===void 0?d.set(f,new Set([p])):E.add(p)}).finally(()=>{const E=u.get(f);E!==void 0&&E.delete(p)}),M}},ne=(e,t)=>{const n=e.get(t);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},it=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return e.delete(r),r},Kn=(e,t,n,r)=>{const o=ne(e,t),s=it(o,a=>a[0]===n&&a[1]===r);return o.size===0&&e.delete(t),s},Be=e=>ne(Yn,e),Ue=e=>{if(Se.has(e))throw new Error("The AudioNode is already stored.");Se.add(e),Be(e).forEach(t=>t(!0))},Qn=e=>"port"in e,ct=e=>{if(!Se.has(e))throw new Error("The AudioNode is not stored.");Se.delete(e),Be(e).forEach(t=>t(!1))},It=(e,t)=>{!Qn(e)&&t.every(n=>n.size===0)&&ct(e)},Ho=(e,t,n,r,o,s,a,c,i,u,d,l,h)=>{const m=new WeakMap;return(f,p,g,v,w)=>{const{activeInputs:_,passiveInputs:M}=s(p),{outputs:E}=s(f),A=c(f),b=y=>{const R=i(p),I=i(f);if(y){const N=Kn(M,f,g,v);e(_,f,N,!1),!w&&!l(f)&&n(I,R,g,v),h(p)&&Ue(p)}else{const N=r(_,f,g,v);t(M,v,N,!1),!w&&!l(f)&&o(I,R,g,v);const P=a(p);if(P===0)d(p)&&It(p,_);else{const L=m.get(p);L!==void 0&&clearTimeout(L),m.set(p,setTimeout(()=>{d(p)&&It(p,_)},P*1e3))}}};return u(E,[p,g,v],y=>y[0]===p&&y[1]===g&&y[2]===v,!0)?(A.add(b),d(f)?e(_,f,[g,v,b],!0):t(M,v,[f,g,b],!0),!0):!1}},Yo=e=>(t,n,[r,o,s],a)=>{const c=t.get(r);c===void 0?t.set(r,new Set([[o,n,s]])):e(c,[o,n,s],i=>i[0]===o&&i[1]===n,a)},Zo=e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const o=()=>{n.removeEventListener("ended",o),n.disconnect(r),r.disconnect()};n.addEventListener("ended",o)},Ko=e=>(t,n)=>{e(t).add(n)},Wt=(e,t)=>e.context===t,En=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Ee=()=>new DOMException("","IndexSizeError"),Qo=e=>{e.getChannelData=(t=>n=>{try{return t.call(e,n)}catch(r){throw r.code===12?Ee():r}})(e.getChannelData)},Jo={numberOfChannels:1},es=(e,t,n,r,o,s,a,c)=>{let i=null;return class Jn{constructor(d){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:m}={...Jo,...d};i===null&&(i=new o(1,1,44100));const f=r!==null&&t(s,s)?new r({length:l,numberOfChannels:h,sampleRate:m}):i.createBuffer(h,l,m);if(f.numberOfChannels===0)throw n();return typeof f.copyFromChannel!="function"?(a(f),Qo(f)):t(En,()=>En(f))||c(f),e.add(f),f}static[Symbol.hasInstance](d){return d!==null&&typeof d=="object"&&Object.getPrototypeOf(d)===Jn.prototype||e.has(d)}}},xe=-34028234663852886e22,ut=-xe,pe=e=>Se.has(e),ts={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},ns=(e,t,n,r,o,s,a,c)=>class extends e{constructor(u,d){const l=s(u),h={...ts,...d},m=o(l,h),f=a(l),p=f?t():null;super(u,!1,m,p),this._audioBufferSourceNodeRenderer=p,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=m,this._onended=null,this._playbackRate=n(this,f,m.playbackRate,ut,xe)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){const d=typeof u=="function"?c(this,u):null;this._nativeAudioBufferSourceNode.onended=d;const l=this._nativeAudioBufferSourceNode.onended;this._onended=l!==null&&l===d?u:l}get playbackRate(){return this._playbackRate}start(u=0,d=0,l){if(this._nativeAudioBufferSourceNode.start(u,d,l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=l===void 0?[u,d]:[u,d,l]),this.context.state!=="closed"){Ue(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),pe(this)&&ct(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}},rs=(e,t,n,r,o)=>()=>{const s=new WeakMap;let a=null,c=null;const i=async(u,d)=>{let l=n(u);const h=Wt(l,d);if(!h){const m={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=t(d,m),a!==null&&l.start(...a),c!==null&&l.stop(c)}return s.set(d,l),h?await e(d,u.playbackRate,l.playbackRate):await r(d,u.playbackRate,l.playbackRate),await o(u,d,l),l};return{set start(u){a=u},set stop(u){c=u},render(u,d){const l=s.get(d);return l!==void 0?Promise.resolve(l):i(u,d)}}},os=e=>"playbackRate"in e,ss=e=>"frequency"in e&&"gain"in e,as=e=>"offset"in e,is=e=>!("frequency"in e)&&"gain"in e,cs=e=>"detune"in e&&"frequency"in e&&!("gain"in e),us=e=>"pan"in e,Q=e=>ne(qn,e),De=e=>ne(zn,e),Ut=(e,t)=>{const{activeInputs:n}=Q(e);n.forEach(o=>o.forEach(([s])=>{t.includes(e)||Ut(s,[...t,e])}));const r=os(e)?[e.playbackRate]:Qn(e)?Array.from(e.parameters.values()):ss(e)?[e.Q,e.detune,e.frequency,e.gain]:as(e)?[e.offset]:is(e)?[e.gain]:cs(e)?[e.detune,e.frequency]:us(e)?[e.pan]:[];for(const o of r){const s=De(o);s!==void 0&&s.activeInputs.forEach(([a])=>Ut(a,t))}pe(e)&&ct(e)},ls=e=>{Ut(e.destination,[])},ds=e=>e===void 0||typeof e=="number"||typeof e=="string"&&(e==="balanced"||e==="interactive"||e==="playback"),fs=(e,t,n,r,o,s,a,c)=>class extends e{constructor(u,d){const l=s(u),h=a(l),m=o(l,d,h),f=h?t(c):null;super(u,!1,m,f),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=m}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},hs=e=>{const t=new WeakMap,n=async(r,o)=>{const s=o.destination;return t.set(o,s),await e(r,o,s),s};return{render(r,o){const s=t.get(o);return s!==void 0?Promise.resolve(s):n(r,o)}}},ps=(e,t,n,r,o,s,a,c)=>(i,u)=>{const d=u.listener,l=()=>{const E=new Float32Array(1),A=t(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),b=a(u);let y=!1,R=[0,0,-1,0,1,0],I=[0,0,0];const N=()=>{if(y)return;y=!0;const B=r(u,256,9,0);B.onaudioprocess=({inputBuffer:U})=>{const x=[s(U,E,0),s(U,E,1),s(U,E,2),s(U,E,3),s(U,E,4),s(U,E,5)];x.some((S,C)=>S!==R[C])&&(d.setOrientation(...x),R=x);const k=[s(U,E,6),s(U,E,7),s(U,E,8)];k.some((S,C)=>S!==I[C])&&(d.setPosition(...k),I=k)},A.connect(B)},P=B=>U=>{U!==R[B]&&(R[B]=U,d.setOrientation(...R))},L=B=>U=>{U!==I[B]&&(I[B]=U,d.setPosition(...I))},D=(B,U,x)=>{const k=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:U});k.connect(A,0,B),k.start(),Object.defineProperty(k.offset,"defaultValue",{get(){return U}});const S=e({context:i},b,k.offset,ut,xe);return c(S,"value",C=>()=>C.call(S),C=>W=>{try{C.call(S,W)}catch(G){if(G.code!==9)throw G}N(),b&&x(W)}),S.cancelAndHoldAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.cancelAndHoldAtTime),S.cancelScheduledValues=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.cancelScheduledValues),S.exponentialRampToValueAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.exponentialRampToValueAtTime),S.linearRampToValueAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.linearRampToValueAtTime),S.setTargetAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.setTargetAtTime),S.setValueAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.setValueAtTime),S.setValueCurveAtTime=(C=>b?()=>{throw o()}:(...W)=>{const G=C.apply(S,W);return N(),G})(S.setValueCurveAtTime),S};return{forwardX:D(0,0,P(0)),forwardY:D(1,0,P(1)),forwardZ:D(2,-1,P(2)),positionX:D(6,0,L(0)),positionY:D(7,0,L(1)),positionZ:D(8,0,L(2)),upX:D(3,0,P(3)),upY:D(4,1,P(4)),upZ:D(5,0,P(5))}},{forwardX:h,forwardY:m,forwardZ:f,positionX:p,positionY:g,positionZ:v,upX:w,upY:_,upZ:M}=d.forwardX===void 0?l():d;return{get forwardX(){return h},get forwardY(){return m},get forwardZ(){return f},get positionX(){return p},get positionY(){return g},get positionZ(){return v},get upX(){return w},get upY(){return _},get upZ(){return M}}},et=e=>"context"in e,We=e=>et(e[0]),be=(e,t,n,r)=>{for(const o of e)if(n(o)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},bn=(e,t,[n,r],o)=>{be(e,[t,n,r],s=>s[0]===t&&s[1]===n,o)},An=(e,[t,n,r],o)=>{const s=e.get(t);s===void 0?e.set(t,new Set([[n,r]])):be(s,[n,r],a=>a[0]===n,o)},er=e=>"inputs"in e,Lt=(e,t,n,r)=>{if(er(t)){const o=t.inputs[r];return e.connect(o,n,0),[o,n,0]}return e.connect(t,n,r),[t,n,r]},tr=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},ms=(e,t,n)=>it(e,r=>r[0]===t&&r[1]===n),nr=(e,t)=>{if(!Be(e).delete(t))throw new Error("Missing the expected event listener.")},rr=(e,t,n)=>{const r=ne(e,t),o=it(r,s=>s[0]===n);return r.size===0&&e.delete(t),o},Pt=(e,t,n,r)=>{er(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},ee=e=>ne(Gn,e),Le=e=>ne(Xn,e),ye=e=>St.has(e),Ze=e=>!Se.has(e),Tn=(e,t)=>new Promise(n=>{if(t!==null)n(!0);else{const r=e.createScriptProcessor(256,1,1),o=e.createGain(),s=e.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const c=e.createBufferSource();c.buffer=s,c.loop=!0,c.connect(r).connect(e.destination),c.connect(o),c.disconnect(o),r.onaudioprocess=i=>{const u=i.inputBuffer.getChannelData(0);Array.prototype.some.call(u,d=>d===1)?n(!0):n(!1),c.stop(),r.onaudioprocess=null,c.disconnect(r),r.disconnect(e.destination)},c.start()}}),At=(e,t)=>{const n=new Map;for(const r of e)for(const o of r){const s=n.get(o);n.set(o,s===void 0?1:s+1)}n.forEach((r,o)=>t(o,r))},tt=e=>"context"in e,gs=e=>{const t=new Map;e.connect=(n=>(r,o=0,s=0)=>{const a=tt(r)?n(r,o,s):n(r,o),c=t.get(r);return c===void 0?t.set(r,[{input:s,output:o}]):c.every(i=>i.input!==s||i.output!==o)&&c.push({input:s,output:o}),a})(e.connect.bind(e)),e.disconnect=(n=>(r,o,s)=>{if(n.apply(e),r===void 0)t.clear();else if(typeof r=="number")for(const[a,c]of t){const i=c.filter(u=>u.output!==r);i.length===0?t.delete(a):t.set(a,i)}else if(t.has(r))if(o===void 0)t.delete(r);else{const a=t.get(r);if(a!==void 0){const c=a.filter(i=>i.output!==o&&(i.input!==s||s===void 0));c.length===0?t.delete(r):t.set(r,c)}}for(const[a,c]of t)c.forEach(i=>{tt(a)?e.connect(a,i.output,i.input):e.connect(a,i.output)})})(e.disconnect)},vs=(e,t,n,r)=>{const{activeInputs:o,passiveInputs:s}=De(t),{outputs:a}=Q(e),c=Be(e),i=u=>{const d=ee(e),l=Le(t);if(u){const h=rr(s,e,n);bn(o,e,h,!1),!r&&!ye(e)&&d.connect(l,n)}else{const h=ms(o,e,n);An(s,h,!1),!r&&!ye(e)&&d.disconnect(l,n)}};return be(a,[t,n],u=>u[0]===t&&u[1]===n,!0)?(c.add(i),pe(e)?bn(o,e,[n,i],!0):An(s,[e,n,i],!0),!0):!1},ws=(e,t,n,r)=>{const{activeInputs:o,passiveInputs:s}=Q(t),a=tr(o[r],e,n);return a===null?[Kn(s,e,n,r)[2],!1]:[a[2],!0]},_s=(e,t,n)=>{const{activeInputs:r,passiveInputs:o}=De(t),s=tr(r,e,n);return s===null?[rr(o,e,n)[1],!1]:[s[2],!0]},Vt=(e,t,n,r,o)=>{const[s,a]=ws(e,n,r,o);if(s!==null&&(nr(e,s),a&&!t&&!ye(e)&&Pt(ee(e),ee(n),r,o)),pe(n)){const{activeInputs:c}=Q(n);It(n,c)}},jt=(e,t,n,r)=>{const[o,s]=_s(e,n,r);o!==null&&(nr(e,o),s&&!t&&!ye(e)&&ee(e).disconnect(Le(n),r))},ys=(e,t)=>{const n=Q(e),r=[];for(const o of n.outputs)We(o)?Vt(e,t,...o):jt(e,t,...o),r.push(o[0]);return n.outputs.clear(),r},Es=(e,t,n)=>{const r=Q(e),o=[];for(const s of r.outputs)s[1]===n&&(We(s)?Vt(e,t,...s):jt(e,t,...s),o.push(s[0]),r.outputs.delete(s));return o},bs=(e,t,n,r,o)=>{const s=Q(e);return Array.from(s.outputs).filter(a=>a[0]===n&&(r===void 0||a[1]===r)&&(o===void 0||a[2]===o)).map(a=>(We(a)?Vt(e,t,...a):jt(e,t,...a),s.outputs.delete(a),a[0]))},As=(e,t,n,r,o,s,a,c,i,u,d,l,h,m,f,p)=>class extends u{constructor(v,w,_,M){super(_),this._context=v,this._nativeAudioNode=_;const E=d(v);l(E)&&n(Tn,()=>Tn(E,p))!==!0&&gs(_),Gn.set(this,_),Yn.set(this,new Set),v.state!=="closed"&&w&&Ue(this),e(this,M,_)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,w=0,_=0){if(w<0||w>=this._nativeAudioNode.numberOfOutputs)throw o();const M=d(this._context),E=f(M);if(h(v)||m(v))throw s();if(et(v)){const y=ee(v);try{const I=Lt(this._nativeAudioNode,y,w,_),N=Ze(this);(E||N)&&this._nativeAudioNode.disconnect(...I),this.context.state!=="closed"&&!N&&Ze(v)&&Ue(v)}catch(I){throw I.code===12?s():I}if(t(this,v,w,_,E)){const I=i([this],v);At(I,r(E))}return v}const A=Le(v);if(A.name==="playbackRate"&&A.maxValue===1024)throw a();try{this._nativeAudioNode.connect(A,w),(E||Ze(this))&&this._nativeAudioNode.disconnect(A,w)}catch(y){throw y.code===12?s():y}if(vs(this,v,w,E)){const y=i([this],v);At(y,r(E))}}disconnect(v,w,_){let M;const E=d(this._context),A=f(E);if(v===void 0)M=ys(this,A);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw o();M=Es(this,A,v)}else{if(w!==void 0&&(w<0||w>=this.numberOfOutputs)||et(v)&&_!==void 0&&(_<0||_>=v.numberOfInputs))throw o();if(M=bs(this,A,v,w,_),M.length===0)throw s()}for(const b of M){const y=i([this],b);At(y,c)}}},Ts=(e,t,n,r,o,s,a,c,i,u,d,l,h)=>(m,f,p,g=null,v=null)=>{const w=p.value,_=new Bo(w),M=f?r(_):null,E={get defaultValue(){return w},get maxValue(){return g===null?p.maxValue:g},get minValue(){return v===null?p.minValue:v},get value(){return p.value},set value(A){p.value=A,E.setValueAtTime(A,m.context.currentTime)},cancelAndHoldAtTime(A){if(typeof p.cancelAndHoldAtTime=="function")M===null&&_.flush(m.context.currentTime),_.add(o(A)),p.cancelAndHoldAtTime(A);else{const b=Array.from(_).pop();M===null&&_.flush(m.context.currentTime),_.add(o(A));const y=Array.from(_).pop();p.cancelScheduledValues(A),b!==y&&y!==void 0&&(y.type==="exponentialRampToValue"?p.exponentialRampToValueAtTime(y.value,y.endTime):y.type==="linearRampToValue"?p.linearRampToValueAtTime(y.value,y.endTime):y.type==="setValue"?p.setValueAtTime(y.value,y.startTime):y.type==="setValueCurve"&&p.setValueCurveAtTime(y.values,y.startTime,y.duration))}return E},cancelScheduledValues(A){return M===null&&_.flush(m.context.currentTime),_.add(s(A)),p.cancelScheduledValues(A),E},exponentialRampToValueAtTime(A,b){if(A===0)throw new RangeError;if(!Number.isFinite(b)||b<0)throw new RangeError;const y=m.context.currentTime;return M===null&&_.flush(y),Array.from(_).length===0&&(_.add(u(w,y)),p.setValueAtTime(w,y)),_.add(a(A,b)),p.exponentialRampToValueAtTime(A,b),E},linearRampToValueAtTime(A,b){const y=m.context.currentTime;return M===null&&_.flush(y),Array.from(_).length===0&&(_.add(u(w,y)),p.setValueAtTime(w,y)),_.add(c(A,b)),p.linearRampToValueAtTime(A,b),E},setTargetAtTime(A,b,y){return M===null&&_.flush(m.context.currentTime),_.add(i(A,b,y)),p.setTargetAtTime(A,b,y),E},setValueAtTime(A,b){return M===null&&_.flush(m.context.currentTime),_.add(u(A,b)),p.setValueAtTime(A,b),E},setValueCurveAtTime(A,b,y){const R=A instanceof Float32Array?A:new Float32Array(A);if(l!==null&&l.name==="webkitAudioContext"){const I=b+y,N=m.context.sampleRate,P=Math.ceil(b*N),L=Math.floor(I*N),D=L-P,B=new Float32Array(D);for(let x=0;x<D;x+=1){const k=(R.length-1)/y*((P+x)/N-b),S=Math.floor(k),C=Math.ceil(k);B[x]=S===C?R[S]:(1-(k-S))*R[S]+(1-(C-k))*R[C]}M===null&&_.flush(m.context.currentTime),_.add(d(B,b,y)),p.setValueCurveAtTime(B,b,y);const U=L/N;U<I&&h(E,B[B.length-1],U),h(E,R[R.length-1],I)}else M===null&&_.flush(m.context.currentTime),_.add(d(R,b,y)),p.setValueCurveAtTime(R,b,y);return E}};return n.set(E,p),t.set(E,m),e(E,M),E},Cs=e=>({replay(t){for(const n of e)if(n.type==="exponentialRampToValue"){const{endTime:r,value:o}=n;t.exponentialRampToValueAtTime(o,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:o}=n;t.linearRampToValueAtTime(o,r)}else if(n.type==="setTarget"){const{startTime:r,target:o,timeConstant:s}=n;t.setTargetAtTime(o,r,s)}else if(n.type==="setValue"){const{startTime:r,value:o}=n;t.setValueAtTime(o,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:o,values:s}=n;t.setValueCurveAtTime(s,o,r)}else throw new Error("Can't apply an unknown automation.")}});class or{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,n=null){return this._map.forEach((r,o)=>t.call(n,r,o,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const Ms={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Ns=(e,t,n,r,o,s,a,c,i,u,d,l,h,m)=>class extends t{constructor(p,g,v){var w;const _=c(p),M=i(_),E=d({...Ms,...v});h(E);const A=Ot.get(_),b=A?.get(g),y=M||_.state!=="closed"?_:(w=a(_))!==null&&w!==void 0?w:_,R=o(y,M?null:p.baseLatency,u,g,b,E),I=M?r(g,E,b):null;super(p,!0,R,I);const N=[];R.parameters.forEach((L,D)=>{const B=n(this,M,L);N.push([D,B])}),this._nativeAudioWorkletNode=R,this._onprocessorerror=null,this._parameters=new or(N),M&&e(_,this);const{activeInputs:P}=s(this);l(R,P)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(p){const g=typeof p=="function"?m(this,p):null;this._nativeAudioWorkletNode.onprocessorerror=g;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===g?p:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function nt(e,t,n,r,o){if(typeof e.copyFromChannel=="function")t[n].byteLength===0&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,o);else{const s=e.getChannelData(r);if(t[n].byteLength===0)t[n]=s.slice(o,o+128);else{const a=new Float32Array(s.buffer,o*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(a)}}}const sr=(e,t,n,r,o)=>{typeof e.copyToChannel=="function"?t[n].byteLength!==0&&e.copyToChannel(t[n],r,o):t[n].byteLength!==0&&e.getChannelData(r).set(t[n],o)},rt=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const o=[],s=typeof t=="number"?t:t[r];for(let a=0;a<s;a+=1)o.push(new Float32Array(128));n.push(o)}return n},Rs=(e,t)=>{const n=ne(kt,e),r=ee(t);return ne(n,r)},Ss=async(e,t,n,r,o,s,a)=>{const c=t===null?Math.ceil(e.context.length/128)*128:t.length,i=r.channelCount*r.numberOfInputs,u=o.reduce((g,v)=>g+v,0),d=u===0?null:n.createBuffer(u,c,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const l=Q(e),h=await Rs(n,e),m=rt(r.numberOfInputs,r.channelCount),f=rt(r.numberOfOutputs,o),p=Array.from(e.parameters.keys()).reduce((g,v)=>({...g,[v]:new Float32Array(128)}),{});for(let g=0;g<c;g+=128){if(r.numberOfInputs>0&&t!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let w=0;w<r.channelCount;w+=1)nt(t,m[v],w,w,g);s.parameterDescriptors!==void 0&&t!==null&&s.parameterDescriptors.forEach(({name:v},w)=>{nt(t,p,v,i+w,g)});for(let v=0;v<r.numberOfInputs;v+=1)for(let w=0;w<o[v];w+=1)f[v][w].byteLength===0&&(f[v][w]=new Float32Array(128));try{const v=m.map((_,M)=>l.activeInputs[M].size===0?[]:_),w=a(g/n.sampleRate,n.sampleRate,()=>h.process(v,f,p));if(d!==null)for(let _=0,M=0;_<r.numberOfOutputs;_+=1){for(let E=0;E<o[_];E+=1)sr(d,f[_],E,M+E,g);M+=o[_]}if(!w)break}catch(v){e.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return d},Os=(e,t,n,r,o,s,a,c,i,u,d,l,h,m,f,p)=>(g,v,w)=>{const _=new WeakMap;let M=null;const E=async(A,b)=>{let y=d(A),R=null;const I=Wt(y,b),N=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(l===null){const P=N.reduce((U,x)=>U+x,0),L=o(b,{channelCount:Math.max(1,P),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,P)}),D=[];for(let U=0;U<A.numberOfOutputs;U+=1)D.push(r(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:N[U]}));const B=a(b,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});B.connect=t.bind(null,D),B.disconnect=i.bind(null,D),R=[L,D,B]}else I||(y=new l(b,g));if(_.set(b,R===null?y:R[2]),R!==null){if(M===null){if(w===void 0)throw new Error("Missing the processor constructor.");if(h===null)throw new Error("Missing the native OfflineAudioContext constructor.");const x=A.channelCount*A.numberOfInputs,k=w.parameterDescriptors===void 0?0:w.parameterDescriptors.length,S=x+k;M=Ss(A,S===0?null:await(async()=>{const W=new h(S,Math.ceil(A.context.length/128)*128,b.sampleRate),G=[],H=[];for(let $=0;$<v.numberOfInputs;$+=1)G.push(a(W,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),H.push(o(W,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ae=await Promise.all(Array.from(A.parameters.values()).map(async $=>{const Z=s(W,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:$.value});return await m(W,$,Z.offset),Z})),ue=r(W,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+k)});for(let $=0;$<v.numberOfInputs;$+=1){G[$].connect(H[$]);for(let Z=0;Z<v.channelCount;Z+=1)H[$].connect(ue,Z,$*v.channelCount+Z)}for(const[$,Z]of ae.entries())Z.connect(ue,0,x+$),Z.start(0);return ue.connect(W.destination),await Promise.all(G.map($=>f(A,W,$))),p(W)})(),b,v,N,w,u)}const P=await M,L=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[D,B,U]=R;P!==null&&(L.buffer=P,L.start(0)),L.connect(D);for(let x=0,k=0;x<A.numberOfOutputs;x+=1){const S=B[x];for(let C=0;C<N[x];C+=1)D.connect(S,k+C,C);k+=N[x]}return U}if(I)for(const[P,L]of A.parameters.entries())await e(b,L,y.parameters.get(P));else for(const[P,L]of A.parameters.entries())await m(b,L,y.parameters.get(P));return await f(A,b,y),y};return{render(A,b){c(b,A);const y=_.get(b);return y!==void 0?Promise.resolve(y):E(A,b)}}},ks=(e,t)=>(n,r)=>{const o=t.get(n);if(o!==void 0)return o;const s=e.get(n);if(s!==void 0)return s;try{const a=r();return a instanceof Promise?(e.set(n,a),a.catch(()=>!1).then(c=>(e.delete(n),t.set(n,c),c))):(t.set(n,a),a)}catch{return t.set(n,!1),!1}},Is=e=>(t,n,r)=>e(n,t,r),Us=e=>(t,n,r=0,o=0)=>{const s=t[r];if(s===void 0)throw e();return tt(n)?s.connect(n,0,o):s.connect(n,0)},Ls={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Ps=(e,t,n,r,o,s,a)=>class extends e{constructor(i,u){const d=o(i),l={...Ls,...u},h=r(d,l),m=s(d),f=m?n():null;super(i,!1,h,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=h,this._offset=t(this,m,h.offset,ut,xe),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(i){const u=typeof i=="function"?a(this,i):null;this._nativeConstantSourceNode.onended=u;const d=this._nativeConstantSourceNode.onended;this._onended=d!==null&&d===u?i:d}start(i=0){if(this._nativeConstantSourceNode.start(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=i),this.context.state!=="closed"){Ue(this);const u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),pe(this)&&ct(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(i=0){this._nativeConstantSourceNode.stop(i),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=i)}},Bs=(e,t,n,r,o)=>()=>{const s=new WeakMap;let a=null,c=null;const i=async(u,d)=>{let l=n(u);const h=Wt(l,d);if(!h){const m={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=t(d,m),a!==null&&l.start(a),c!==null&&l.stop(c)}return s.set(d,l),h?await e(d,u.offset,l.offset):await r(d,u.offset,l.offset),await o(u,d,l),l};return{set start(u){a=u},set stop(u){c=u},render(u,d){const l=s.get(d);return l!==void 0?Promise.resolve(l):i(u,d)}}},xs=e=>t=>(e[0]=t,e[0]),Ds=(e,t,n,r,o,s,a,c)=>(i,u)=>{const d=t.get(i);if(d===void 0)throw new Error("Missing the expected cycle count.");const l=s(i.context),h=c(l);if(d===u){if(t.delete(i),!h&&a(i)){const m=r(i),{outputs:f}=n(i);for(const p of f)if(We(p)){const g=r(p[0]);e(m,g,p[1],p[2])}else{const g=o(p[0]);m.connect(g,p[1])}}}else t.set(i,d-u)},Ws=e=>(t,n,r,o)=>e(t[o],s=>s[0]===n&&s[1]===r),Vs=e=>(t,n)=>{e(t).delete(n)},js=e=>"delayTime"in e,Fs=(e,t,n)=>function r(o,s){const a=et(s)?s:n(e,s);if(js(a))return[];if(o[0]===a)return[o];if(o.includes(a))return[];const{outputs:c}=t(a);return Array.from(c).map(i=>r([...o,a],i[0])).reduce((i,u)=>i.concat(u),[])},Ye=(e,t,n)=>{const r=t[n];if(r===void 0)throw e();return r},$s=e=>(t,n=void 0,r=void 0,o=0)=>n===void 0?t.forEach(s=>s.disconnect()):typeof n=="number"?Ye(e,t,n).disconnect():tt(n)?r===void 0?t.forEach(s=>s.disconnect(n)):o===void 0?Ye(e,t,r).disconnect(n,0):Ye(e,t,r).disconnect(n,0,o):r===void 0?t.forEach(s=>s.disconnect(n)):Ye(e,t,r).disconnect(n,0),qs=e=>t=>new Promise((n,r)=>{if(e===null){r(new SyntaxError);return}const o=e.document.head;if(o===null)r(new SyntaxError);else{const s=e.document.createElement("script"),a=new Blob([t],{type:"application/javascript"}),c=URL.createObjectURL(a),i=e.onerror,u=()=>{e.onerror=i,URL.revokeObjectURL(c)};e.onerror=(d,l,h,m,f)=>{if(l===c||l===e.location.href&&h===1&&m===1)return u(),r(f),!1;if(i!==null)return i(d,l,h,m,f)},s.onerror=()=>{u(),r(new SyntaxError)},s.onload=()=>{u(),n()},s.src=c,s.type="module",o.appendChild(s)}}),Gs=e=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,o){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=e(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,o)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,o){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,o)}},zs=e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get(){return Math.round(t*n)}},currentTime:{configurable:!0,get(){return t}}});try{return r()}finally{e!==null&&(delete e.currentFrame,delete e.currentTime)}},Xs=e=>async t=>{try{const n=await fetch(t);if(n.ok)return[await n.text(),n.url]}catch{}throw e()},Hs=(e,t)=>n=>t(e,n),Ys=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},Zs=e=>t=>{var n;return(n=e.get(t))!==null&&n!==void 0?n:0},Ks=e=>t=>{const n=e(t);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},Qs=e=>t=>e.get(t),te=()=>new DOMException("","InvalidStateError"),Js=e=>t=>{const n=e.get(t);if(n===void 0)throw te();return n},ea=(e,t)=>n=>{let r=e.get(n);if(r!==void 0)return r;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),e.set(n,r),r},ta=e=>t=>{const n=e.get(t);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},na=()=>new DOMException("","InvalidAccessError"),ra=(e,t,n,r,o,s)=>a=>(c,i)=>{const u=e.get(c);if(u===void 0){if(!a&&s(c)){const d=r(c),{outputs:l}=n(c);for(const h of l)if(We(h)){const m=r(h[0]);t(d,m,h[1],h[2])}else{const m=o(h[0]);d.disconnect(m,h[1])}}e.set(c,i)}else e.set(c,u+i)},oa=e=>t=>e!==null&&t instanceof e,sa=e=>t=>e!==null&&typeof e.AudioNode=="function"&&t instanceof e.AudioNode,aa=e=>t=>e!==null&&typeof e.AudioParam=="function"&&t instanceof e.AudioParam,ia=e=>t=>e!==null&&t instanceof e,ca=e=>e!==null&&e.isSecureContext,ua=(e,t,n,r)=>class extends e{constructor(s,a){const c=n(s),i=t(c,a);if(r(c))throw new TypeError;super(s,!0,i,null),this._nativeMediaStreamAudioSourceNode=i}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},la=(e,t,n,r,o)=>class extends r{constructor(a={}){if(o===null)throw new Error("Missing the native AudioContext constructor.");let c;try{c=new o(a)}catch(d){throw d.code===12&&d.message==="sampleRate is not in range"?t():d}if(c===null)throw n();if(!ds(a.latencyHint))throw new TypeError(`The provided value '${a.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(a.sampleRate!==void 0&&c.sampleRate!==a.sampleRate)throw t();super(c,2);const{latencyHint:i}=a,{sampleRate:u}=c;if(this._baseLatency=typeof c.baseLatency=="number"?c.baseLatency:i==="balanced"?512/u:i==="interactive"||i===void 0?256/u:i==="playback"?1024/u:Math.max(2,Math.min(128,Math.round(i*u/128)))*128/u,this._nativeAudioContext=c,o.name==="webkitAudioContext"?(this._nativeGainNode=c.createGain(),this._nativeOscillatorNode=c.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(c.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,c.state==="running"){this._state="suspended";const d=()=>{this._state==="suspended"&&(this._state=null),c.removeEventListener("statechange",d)};c.addEventListener("statechange",d)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),ls(this)}))}resume(){return this._state==="suspended"?new Promise((a,c)=>{const i=()=>{this._nativeAudioContext.removeEventListener("statechange",i),this._nativeAudioContext.state==="running"?a():this.resume().then(a,c)};this._nativeAudioContext.addEventListener("statechange",i)}):this._nativeAudioContext.resume().catch(a=>{throw a===void 0||a.code===15?e():a})}suspend(){return this._nativeAudioContext.suspend().catch(a=>{throw a===void 0?e():a})}},da=(e,t,n,r,o,s)=>class extends n{constructor(c,i){super(c),this._nativeContext=c,Hn.set(this,c),r(c)&&o.set(c,new Set),this._destination=new e(this,i),this._listener=t(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const i=typeof c=="function"?s(this,c):null;this._nativeContext.onstatechange=i;const u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===i?c:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Cn=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},fa=(e,t)=>(n,r,o)=>{const s=new Set;return n.connect=(a=>(c,i=0,u=0)=>{const d=s.size===0;if(t(c))return a.call(n,c,i,u),e(s,[c,i,u],l=>l[0]===c&&l[1]===i&&l[2]===u,!0),d&&r(),c;a.call(n,c,i),e(s,[c,i],l=>l[0]===c&&l[1]===i,!0),d&&r()})(n.connect),n.disconnect=(a=>(c,i,u)=>{const d=s.size>0;if(c===void 0)a.apply(n),s.clear();else if(typeof c=="number"){a.call(n,c);for(const h of s)h[1]===c&&s.delete(h)}else{t(c)?a.call(n,c,i,u):a.call(n,c,i);for(const h of s)h[0]===c&&(i===void 0||h[1]===i)&&(u===void 0||h[2]===u)&&s.delete(h)}const l=s.size===0;d&&l&&o()})(n.disconnect),n},_e=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n]&&(e[n]=r)},Ve=(e,t)=>{_e(e,t,"channelCount"),_e(e,t,"channelCountMode"),_e(e,t,"channelInterpretation")},ha=e=>e===null?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,Ft=(e,t,n)=>{const r=t[n];r!==void 0&&r!==e[n].value&&(e[n].value=r)},pa=e=>{e.start=(t=>{let n=!1;return(r=0,o=0,s)=>{if(n)throw te();t.call(e,r,o,s),n=!0}})(e.start)},ar=e=>{e.start=(t=>(n=0,r=0,o)=>{if(typeof o=="number"&&o<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,o)})(e.start)},ir=e=>{e.stop=(t=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})(e.stop)},ma=(e,t,n,r,o,s,a,c,i,u,d)=>(l,h)=>{const m=l.createBufferSource();return Ve(m,h),Ft(m,h,"playbackRate"),_e(m,h,"buffer"),_e(m,h,"loop"),_e(m,h,"loopEnd"),_e(m,h,"loopStart"),t(n,()=>n(l))||pa(m),t(r,()=>r(l))||i(m),t(o,()=>o(l))||u(m,l),t(s,()=>s(l))||ar(m),t(a,()=>a(l))||d(m,l),t(c,()=>c(l))||ir(m),e(l,m),m},ga=e=>e===null?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,va=(e,t)=>(n,r,o)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}o&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const a=e(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return t(a,"channelCount",c=>()=>c.call(a),c=>i=>{c.call(a,i);try{s.channelCount=i}catch(u){if(i>s.maxChannelCount)throw u}}),t(a,"channelCountMode",c=>()=>c.call(a),c=>i=>{c.call(a,i),s.channelCountMode=i}),t(a,"channelInterpretation",c=>()=>c.call(a),c=>i=>{c.call(a,i),s.channelInterpretation=i}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},wa=e=>e===null?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,_a=e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}},ya=(e,t,n,r,o)=>(s,a,c,i,u,d)=>{if(c!==null)try{const l=new c(s,i,d),h=new Map;let m=null;if(Object.defineProperties(l,{channelCount:{get:()=>d.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>m,set:f=>{typeof m=="function"&&l.removeEventListener("processorerror",m),m=typeof f=="function"?f:null,typeof m=="function"&&l.addEventListener("processorerror",m)}}}),l.addEventListener=(f=>(...p)=>{if(p[0]==="processorerror"){const g=typeof p[1]=="function"?p[1]:typeof p[1]=="object"&&p[1]!==null&&typeof p[1].handleEvent=="function"?p[1].handleEvent:null;if(g!==null){const v=h.get(p[1]);v!==void 0?p[1]=v:(p[1]=w=>{w.type==="error"?(Object.defineProperties(w,{type:{value:"processorerror"}}),g(w)):g(new ErrorEvent(p[0],{...w}))},h.set(g,p[1]))}}return f.call(l,"error",p[1],p[2]),f.call(l,...p)})(l.addEventListener),l.removeEventListener=(f=>(...p)=>{if(p[0]==="processorerror"){const g=h.get(p[1]);g!==void 0&&(h.delete(p[1]),p[1]=g)}return f.call(l,"error",p[1],p[2]),f.call(l,p[0],p[1],p[2])})(l.removeEventListener),d.numberOfOutputs!==0){const f=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return l.connect(f).connect(s.destination),o(l,()=>f.disconnect(),()=>f.connect(s.destination))}return l}catch(l){throw l.code===11?r():l}if(u===void 0)throw r();return _a(d),t(s,a,u,d)},Ea=(e,t)=>e===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),ba=e=>new Promise((t,n)=>{const{port1:r,port2:o}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),o.close(),t(s)},r.onmessageerror=({data:s})=>{r.close(),o.close(),n(s)},o.postMessage(e)}),Aa=async(e,t)=>{const n=await ba(t);return new e(n)},Ta=(e,t,n,r)=>{let o=kt.get(e);o===void 0&&(o=new WeakMap,kt.set(e,o));const s=Aa(n,r);return o.set(t,s),s},Ca=(e,t,n,r,o,s,a,c,i,u,d,l,h)=>(m,f,p,g)=>{if(g.numberOfInputs===0&&g.numberOfOutputs===0)throw i();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some(T=>T<1))throw i();if(v.length!==g.numberOfOutputs)throw t();if(g.channelCountMode!=="explicit")throw i();const w=g.channelCount*g.numberOfInputs,_=v.reduce((T,O)=>T+O,0),M=p.parameterDescriptors===void 0?0:p.parameterDescriptors.length;if(w+M>6||_>6)throw i();const E=new MessageChannel,A=[],b=[];for(let T=0;T<g.numberOfInputs;T+=1)A.push(a(m,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),b.push(o(m,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const y=[];if(p.parameterDescriptors!==void 0)for(const{defaultValue:T,maxValue:O,minValue:z,name:F}of p.parameterDescriptors){const V=s(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:g.parameterData[F]!==void 0?g.parameterData[F]:T===void 0?0:T});Object.defineProperties(V.offset,{defaultValue:{get:()=>T===void 0?0:T},maxValue:{get:()=>O===void 0?ut:O},minValue:{get:()=>z===void 0?xe:z}}),y.push(V)}const R=r(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,w+M)}),I=Ea(f,m.sampleRate),N=c(m,I,w+M,Math.max(1,_)),P=o(m,{channelCount:Math.max(1,_),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,_)}),L=[];for(let T=0;T<g.numberOfOutputs;T+=1)L.push(r(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[T]}));for(let T=0;T<g.numberOfInputs;T+=1){A[T].connect(b[T]);for(let O=0;O<g.channelCount;O+=1)b[T].connect(R,O,T*g.channelCount+O)}const D=new or(p.parameterDescriptors===void 0?[]:p.parameterDescriptors.map(({name:T},O)=>{const z=y[O];return z.connect(R,0,w+O),z.start(0),[T,z.offset]}));R.connect(N);let B=g.channelInterpretation,U=null;const x=g.numberOfOutputs===0?[N]:L,k={get bufferSize(){return I},get channelCount(){return g.channelCount},set channelCount(T){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(T){throw n()},get channelInterpretation(){return B},set channelInterpretation(T){for(const O of A)O.channelInterpretation=T;B=T},get context(){return N.context},get inputs(){return A},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return U},set onprocessorerror(T){typeof U=="function"&&k.removeEventListener("processorerror",U),U=typeof T=="function"?T:null,typeof U=="function"&&k.addEventListener("processorerror",U)},get parameters(){return D},get port(){return E.port2},addEventListener(...T){return N.addEventListener(T[0],T[1],T[2])},connect:e.bind(null,x),disconnect:u.bind(null,x),dispatchEvent(...T){return N.dispatchEvent(T[0])},removeEventListener(...T){return N.removeEventListener(T[0],T[1],T[2])}},S=new Map;E.port1.addEventListener=(T=>(...O)=>{if(O[0]==="message"){const z=typeof O[1]=="function"?O[1]:typeof O[1]=="object"&&O[1]!==null&&typeof O[1].handleEvent=="function"?O[1].handleEvent:null;if(z!==null){const F=S.get(O[1]);F!==void 0?O[1]=F:(O[1]=V=>{d(m.currentTime,m.sampleRate,()=>z(V))},S.set(z,O[1]))}}return T.call(E.port1,O[0],O[1],O[2])})(E.port1.addEventListener),E.port1.removeEventListener=(T=>(...O)=>{if(O[0]==="message"){const z=S.get(O[1]);z!==void 0&&(S.delete(O[1]),O[1]=z)}return T.call(E.port1,O[0],O[1],O[2])})(E.port1.removeEventListener);let C=null;Object.defineProperty(E.port1,"onmessage",{get:()=>C,set:T=>{typeof C=="function"&&E.port1.removeEventListener("message",C),C=typeof T=="function"?T:null,typeof C=="function"&&(E.port1.addEventListener("message",C),E.port1.start())}}),p.prototype.port=E.port1;let W=null;Ta(m,k,p,g).then(T=>W=T);const H=rt(g.numberOfInputs,g.channelCount),ae=rt(g.numberOfOutputs,v),ue=p.parameterDescriptors===void 0?[]:p.parameterDescriptors.reduce((T,{name:O})=>({...T,[O]:new Float32Array(128)}),{});let $=!0;const Z=()=>{g.numberOfOutputs>0&&N.disconnect(P);for(let T=0,O=0;T<g.numberOfOutputs;T+=1){const z=L[T];for(let F=0;F<v[T];F+=1)P.disconnect(z,O+F,F);O+=v[T]}},le=new Map;N.onaudioprocess=({inputBuffer:T,outputBuffer:O})=>{if(W!==null){const z=l(k);for(let F=0;F<I;F+=128){for(let V=0;V<g.numberOfInputs;V+=1)for(let q=0;q<g.channelCount;q+=1)nt(T,H[V],q,q,F);p.parameterDescriptors!==void 0&&p.parameterDescriptors.forEach(({name:V},q)=>{nt(T,ue,V,w+q,F)});for(let V=0;V<g.numberOfInputs;V+=1)for(let q=0;q<v[V];q+=1)ae[V][q].byteLength===0&&(ae[V][q]=new Float32Array(128));try{const V=H.map((K,re)=>{if(z[re].size>0)return le.set(re,I/128),K;const Ne=le.get(re);return Ne===void 0?[]:(K.every(X=>X.every(j=>j===0))&&(Ne===1?le.delete(re):le.set(re,Ne-1)),K)});$=d(m.currentTime+F/m.sampleRate,m.sampleRate,()=>W.process(V,ae,ue));for(let K=0,re=0;K<g.numberOfOutputs;K+=1){for(let ve=0;ve<v[K];ve+=1)sr(O,ae[K],ve,re+ve,F);re+=v[K]}}catch(V){$=!1,k.dispatchEvent(new ErrorEvent("processorerror",{colno:V.colno,filename:V.filename,lineno:V.lineno,message:V.message}))}if(!$){for(let V=0;V<g.numberOfInputs;V+=1){A[V].disconnect(b[V]);for(let q=0;q<g.channelCount;q+=1)b[F].disconnect(R,q,V*g.channelCount+q)}if(p.parameterDescriptors!==void 0){const V=p.parameterDescriptors.length;for(let q=0;q<V;q+=1){const K=y[q];K.disconnect(R,0,w+q),K.stop()}}R.disconnect(N),N.onaudioprocess=null,Te?Z():Me();break}}}};let Te=!1;const Ce=a(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),qe=()=>N.connect(Ce).connect(m.destination),Me=()=>{N.disconnect(Ce),Ce.disconnect()},Ge=()=>{if($){Me(),g.numberOfOutputs>0&&N.connect(P);for(let T=0,O=0;T<g.numberOfOutputs;T+=1){const z=L[T];for(let F=0;F<v[T];F+=1)P.connect(z,O+F,F);O+=v[T]}}Te=!0},gt=()=>{$&&(qe(),Z()),Te=!1};return qe(),h(k,Ge,gt)},Ma=(e,t)=>(n,r)=>{const o=n.createChannelMerger(r.numberOfInputs);return e!==null&&e.name==="webkitAudioContext"&&t(n,o),Ve(o,r),o},Na=e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:n=>{if(n!==t)throw te()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw te()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw te()}})},cr=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return Ve(n,t),Na(n),n},Ra=(e,t,n,r,o)=>(s,a)=>{if(s.createConstantSource===void 0)return n(s,a);const c=s.createConstantSource();return Ve(c,a),Ft(c,a,"offset"),t(r,()=>r(s))||ar(c),t(o,()=>o(s))||ir(c),e(s,c),c},ur=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),Sa=(e,t,n,r)=>(o,{offset:s,...a})=>{const c=o.createBuffer(1,2,44100),i=t(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(o,{...a,gain:s}),d=c.getChannelData(0);d[0]=1,d[1]=1,i.buffer=c,i.loop=!0;const l={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(f){u.channelCount=f},get channelCountMode(){return u.channelCountMode},set channelCountMode(f){u.channelCountMode=f},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(f){u.channelInterpretation=f},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return i.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return i.onended},set onended(f){i.onended=f},addEventListener(...f){return i.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return i.dispatchEvent(f[0])},removeEventListener(...f){return i.removeEventListener(f[0],f[1],f[2])},start(f=0){i.start.call(i,f)},stop(f=0){i.stop.call(i,f)}},h=()=>i.connect(u),m=()=>i.disconnect(u);return e(o,i),r(ur(l,u),h,m)},me=(e,t)=>{const n=e.createGain();return Ve(n,t),Ft(n,t,"gain"),n},Oa=(e,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const r=n.slice(0,1),o=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(o,"mediaStream",{value:t}),o},ka=e=>e===null?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,$t=(e,t,n,r)=>e.createScriptProcessor(t,n,r),Ae=()=>new DOMException("","NotSupportedError"),Ia=(e,t)=>(n,r,o)=>(e(r).replay(o),t(r,n,o)),Ua=(e,t,n)=>async(r,o,s)=>{const a=e(r);await Promise.all(a.activeInputs.map((c,i)=>Array.from(c).map(async([u,d])=>{const h=await t(u).render(u,o),m=r.context.destination;!n(u)&&(r!==m||!n(r))&&h.connect(s,d,i)})).reduce((c,i)=>[...c,...i],[]))},La=(e,t,n)=>async(r,o,s)=>{const a=t(r);await Promise.all(Array.from(a.activeInputs).map(async([c,i])=>{const d=await e(c).render(c,o);n(c)||d.connect(s,i)}))},Pa=(e,t,n,r)=>o=>e(Cn,()=>Cn(o))?Promise.resolve(e(r,r)).then(s=>{if(!s){const a=n(o,512,0,1);o.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>o.currentTime,a.connect(o.destination)}return o.startRendering()}):new Promise(s=>{const a=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=c=>{a.disconnect(),s(c.renderedBuffer)},a.connect(o.destination),o.startRendering()}),Ba=e=>(t,n)=>{e.set(t,n)},xa=e=>()=>{if(e===null)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0},Da=(e,t)=>async()=>{if(e===null)return!0;if(t===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),o=URL.createObjectURL(n);let s=!1,a=!1;try{await r.audioWorklet.addModule(o);const c=new e(r,"a",{numberOfOutputs:0}),i=r.createOscillator();c.port.onmessage=()=>s=!0,c.onprocessorerror=()=>a=!0,i.connect(c),i.start(0),await r.startRendering(),await new Promise(u=>setTimeout(u))}catch{}finally{URL.revokeObjectURL(o)}return s&&!a},Wa=(e,t)=>()=>{if(t===null)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(o=>{n.oncomplete=()=>{r.disconnect(),o(n.currentTime!==0)},n.startRendering()})},Va=()=>new DOMException("","UnknownError"),ja=()=>typeof window>"u"?null:window,Fa=(e,t)=>n=>{n.copyFromChannel=(r,o,s=0)=>{const a=e(s),c=e(o);if(c>=n.numberOfChannels)throw t();const i=n.length,u=n.getChannelData(c),d=r.length;for(let l=a<0?-a:0;l+a<i&&l<d;l+=1)r[l]=u[l+a]},n.copyToChannel=(r,o,s=0)=>{const a=e(s),c=e(o);if(c>=n.numberOfChannels)throw t();const i=n.length,u=n.getChannelData(c),d=r.length;for(let l=a<0?-a:0;l+a<i&&l<d;l+=1)u[l+a]=r[l]}},$a=e=>t=>{t.copyFromChannel=(n=>(r,o,s=0)=>{const a=e(s),c=e(o);if(a<t.length)return n.call(t,r,c,a)})(t.copyFromChannel),t.copyToChannel=(n=>(r,o,s=0)=>{const a=e(s),c=e(o);if(a<t.length)return n.call(t,r,c,a)})(t.copyToChannel)},qa=e=>(t,n)=>{const r=n.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=r),e(t,"buffer",o=>()=>{const s=o.call(t);return s===r?null:s},o=>s=>o.call(t,s===null?r:s))},Ga=(e,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const o=n.createBufferSource();t(r,()=>{const c=r.numberOfInputs;for(let i=0;i<c;i+=1)o.connect(r,0,i)},()=>o.disconnect(r))},za=(e,t,n)=>e.copyFromChannel===void 0?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0]),qt=(e,t,n,r)=>{let o=e;for(;!o.hasOwnProperty(t);)o=Object.getPrototypeOf(o);const{get:s,set:a}=Object.getOwnPropertyDescriptor(o,t);Object.defineProperty(e,t,{get:n(s),set:r(a)})},Xa=e=>({...e,outputChannelCount:e.outputChannelCount!==void 0?e.outputChannelCount:e.numberOfInputs===1&&e.numberOfOutputs===1?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),lr=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(r){if(r.code!==9)throw r;lr(e,t,n+1e-7)}},Ha=e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},Ya=e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0},Za=e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},dr=e=>{const t=e.createOscillator();try{t.start(-1)}catch(n){return n instanceof RangeError}return!1},Ka=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},fr=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(n){return n instanceof RangeError}return!1},Qa=e=>{const{port1:t,port2:n}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),n.close()}},Ja=e=>{e.start=(t=>(n=0,r=0,o)=>{const s=e.buffer,a=s===null?r:Math.min(s.duration,r);s!==null&&a>s.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,a,o)})(e.start)},ei=(e,t)=>{const n=t.createGain();e.connect(n);const r=(o=>()=>{o.call(e,n),e.removeEventListener("ended",r)})(e.disconnect);e.addEventListener("ended",r),ur(e,n),e.stop=(o=>{let s=!1;return(a=0)=>{if(s)try{o.call(e,a)}catch{n.gain.setValueAtTime(0,a)}else o.call(e,a),s=!0}})(e.stop)},je=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof t=="function"?t.call(e,n):t.handleEvent.call(e,n)},ti=$o(be),ni=Yo(be),ri=Ws(it),oi=new WeakMap,si=Zs(oi),Oe=ks(new Map,new WeakMap),oe=ja(),hr=Ys(Q),lt=Ua(Q,hr,ye),ge=Js(Hn),ke=ka(oe),se=ia(ke),pr=new WeakMap,mr=Gs(je),dt=ga(oe),ai=oa(dt),gr=sa(oe),ii=aa(oe),Pe=wa(oe),Fe=As(qo(qn),Ho(ti,ni,Lt,ri,Pt,Q,si,Be,ee,be,pe,ye,Ze),Oe,ra(St,Pt,Q,ee,Le,pe),Ee,na,Ae,Ds(Lt,St,Q,ee,Le,ge,pe,se),Fs(pr,Q,ne),mr,ge,ai,gr,ii,se,Pe),ci=new WeakSet,Mn=ha(oe),vr=xs(new Uint32Array(1)),ui=Fa(vr,Ee),li=$a(vr),di=es(ci,Oe,Ae,Mn,ke,xa(Mn),ui,li),Gt=Zo(me),wr=La(hr,De,ye),zt=Is(wr),ft=ma(Gt,Oe,Ha,Ya,Za,dr,Ka,fr,Ja,qa(qt),ei),Xt=Ia(Ks(De),wr),fi=rs(zt,ft,ee,Xt,lt),ht=Ts(Go(zn),pr,Xn,Cs,xo,Do,Wo,Vo,jo,Mt,Fn,dt,lr),hi=ns(Fe,fi,ht,te,ft,ge,se,je),pi=fs(Fe,hs,Ee,te,va(me,qt),ge,se,lt),pt=fa(be,gr),mi=Ga(te,pt),Ht=Ma(dt,mi),gi=Sa(Gt,ft,me,pt),$e=Ra(Gt,Oe,gi,dr,fr),vi=Bs(zt,$e,ee,Xt,lt),wi=Ps(Fe,ht,vi,$e,ge,se,je),_i=Pa(Oe,me,$t,Wa(me,ke)),yi=ps(ht,Ht,$e,$t,Ae,za,se,qt),_r=new WeakMap,Ei=da(pi,yi,mr,se,_r,je),yr=ca(oe),Yt=zs(oe),Er=new WeakMap,bi=ea(Er,ke),Nn=yr?Xo(Oe,Ae,qs(oe),Yt,Xs(Fo),ge,bi,se,Pe,new WeakMap,new WeakMap,Da(Pe,ke),oe):void 0,Ai=ua(Fe,Oa,ge,se),br=ta(_r),Ti=Ko(br),Ar=Us(Ee),Ci=Vs(br),Tr=$s(Ee),Cr=new WeakMap,Mi=Hs(Cr,ne),Ni=Ca(Ar,Ee,te,Ht,cr,$e,me,$t,Ae,Tr,Yt,Mi,pt),Ri=ya(te,Ni,me,Ae,pt),Si=Os(zt,Ar,ft,Ht,cr,$e,me,Ci,Tr,Yt,ee,Pe,ke,Xt,lt,_i),Oi=Qs(Er),ki=Ba(Cr),Rn=yr?Ns(Ti,Fe,ht,Si,Ri,Q,Oi,ge,se,Pe,Xa,ki,Qa,je):void 0,Ii=la(te,Ae,Va,Ei,dt),Mr="Missing AudioWorklet support. Maybe this is not running in a secure context.",Ui=async(e,t,n,r,o)=>{const{encoderId:s,port:a}=await Dn(o,t.sampleRate);if(Rn===void 0)throw new Error(Mr);const c=new hi(t,{buffer:e}),i=new Ai(t,{mediaStream:r}),u=Uo(Rn,t,{channelCount:n});return{audioBufferSourceNode:c,encoderId:s,mediaStreamAudioSourceNode:i,port:a,recorderAudioWorkletNode:u}},Li=(e,t,n,r)=>(o,s,a)=>{var c;const i=(c=s.getAudioTracks()[0])===null||c===void 0?void 0:c.getSettings().sampleRate,u=new Ii({latencyHint:"playback",sampleRate:i}),d=Math.max(1024,Math.ceil(u.baseLatency*u.sampleRate)),l=new di({length:d,sampleRate:u.sampleRate}),h=[],m=Io(y=>{if(Nn===void 0)throw new Error(Mr);return Nn(u,y)});let f=null,p=null,g=null,v=null,w=!0;const _=y=>{o.dispatchEvent(e("dataavailable",{data:new Blob(y,{type:a})}))},M=async(y,R)=>{const I=await Ke(y,R);g===null?h.push(...I):(_(I),v=M(y,R))},E=()=>(w=!0,u.resume()),A=()=>{g!==null&&(f!==null&&(s.removeEventListener("addtrack",f),s.removeEventListener("removetrack",f)),p!==null&&clearTimeout(p),g.then(async({constantSourceNode:y,encoderId:R,mediaStreamAudioSourceNode:I,recorderAudioWorkletNode:N})=>{v!==null&&(v.catch(()=>{}),v=null),await N.stop(),I.disconnect(N),y.stop();const P=await Ke(R,null);g===null&&await b(),_([...h,...P]),h.length=0,o.dispatchEvent(new Event("stop"))}),g=null)},b=()=>(w=!1,u.suspend());return b(),{get mimeType(){return a},get state(){return g===null?"inactive":w?"recording":"paused"},pause(){if(g===null)throw n();w&&(b(),o.dispatchEvent(new Event("pause")))},resume(){if(g===null)throw n();w||(E(),o.dispatchEvent(new Event("resume")))},start(y){var R;if(g!==null)throw n();if(s.getVideoTracks().length>0)throw r();o.dispatchEvent(new Event("start"));const I=s.getAudioTracks(),N=I.length===0?2:(R=I[0].getSettings().channelCount)!==null&&R!==void 0?R:2;g=Promise.all([E(),m.then(()=>Ui(l,u,N,s,a))]).then(async([,{audioBufferSourceNode:L,encoderId:D,mediaStreamAudioSourceNode:B,port:U,recorderAudioWorkletNode:x}])=>{B.connect(x),await new Promise(S=>{L.onended=S,L.connect(x),L.start(u.currentTime+d/u.sampleRate)}),L.disconnect(x);const k=new wi(u,{offset:0});return k.onended=()=>k.disconnect(),k.connect(u.destination),k.start(),await x.record(U),y!==void 0&&(v=M(D,y)),{constantSourceNode:k,encoderId:D,mediaStreamAudioSourceNode:B,recorderAudioWorkletNode:x}});const P=s.getTracks();f=()=>{A(),o.dispatchEvent(new ErrorEvent("error",{error:t()}))},s.addEventListener("addtrack",f),s.addEventListener("removetrack",f),p=setInterval(()=>{const L=s.getTracks();(L.length!==P.length||L.some((D,B)=>D!==P[B]))&&f!==null&&f()},1e3)},stop:A}};class Tt{constructor(t,n=0,r){if(n<0||r!==void 0&&r<0)throw new RangeError;const o=t.reduce((d,l)=>d+l.byteLength,0);if(n>o||r!==void 0&&n+r>o)throw new RangeError;const s=[],a=r===void 0?o-n:r,c=[];let i=0,u=n;for(const d of t)if(c.length===0)if(d.byteLength>u){i=d.byteLength-u;const l=i>a?a:i;s.push(new DataView(d,u,l)),c.push(d)}else u-=d.byteLength;else if(i<a){i+=d.byteLength;const l=i>a?d.byteLength-i+a:d.byteLength;s.push(new DataView(d,0,l)),c.push(d)}this._buffers=c,this._byteLength=a,this._byteOffset=u,this._dataViews=s,this._internalBuffer=new DataView(new ArrayBuffer(8))}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get byteOffset(){return this._byteOffset}getFloat32(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.setUint8(2,this.getUint8(t+2)),this._internalBuffer.setUint8(3,this.getUint8(t+3)),this._internalBuffer.getFloat32(0,n)}getFloat64(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.setUint8(2,this.getUint8(t+2)),this._internalBuffer.setUint8(3,this.getUint8(t+3)),this._internalBuffer.setUint8(4,this.getUint8(t+4)),this._internalBuffer.setUint8(5,this.getUint8(t+5)),this._internalBuffer.setUint8(6,this.getUint8(t+6)),this._internalBuffer.setUint8(7,this.getUint8(t+7)),this._internalBuffer.getFloat64(0,n)}getInt16(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.getInt16(0,n)}getInt32(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.setUint8(2,this.getUint8(t+2)),this._internalBuffer.setUint8(3,this.getUint8(t+3)),this._internalBuffer.getInt32(0,n)}getInt8(t){const[n,r]=this._findDataViewWithOffset(t);return n.getInt8(t-r)}getUint16(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.getUint16(0,n)}getUint32(t,n){return this._internalBuffer.setUint8(0,this.getUint8(t+0)),this._internalBuffer.setUint8(1,this.getUint8(t+1)),this._internalBuffer.setUint8(2,this.getUint8(t+2)),this._internalBuffer.setUint8(3,this.getUint8(t+3)),this._internalBuffer.getUint32(0,n)}getUint8(t){const[n,r]=this._findDataViewWithOffset(t);return n.getUint8(t-r)}setFloat32(t,n,r){this._internalBuffer.setFloat32(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1)),this.setUint8(t+2,this._internalBuffer.getUint8(2)),this.setUint8(t+3,this._internalBuffer.getUint8(3))}setFloat64(t,n,r){this._internalBuffer.setFloat64(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1)),this.setUint8(t+2,this._internalBuffer.getUint8(2)),this.setUint8(t+3,this._internalBuffer.getUint8(3)),this.setUint8(t+4,this._internalBuffer.getUint8(4)),this.setUint8(t+5,this._internalBuffer.getUint8(5)),this.setUint8(t+6,this._internalBuffer.getUint8(6)),this.setUint8(t+7,this._internalBuffer.getUint8(7))}setInt16(t,n,r){this._internalBuffer.setInt16(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1))}setInt32(t,n,r){this._internalBuffer.setInt32(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1)),this.setUint8(t+2,this._internalBuffer.getUint8(2)),this.setUint8(t+3,this._internalBuffer.getUint8(3))}setInt8(t,n){const[r,o]=this._findDataViewWithOffset(t);r.setInt8(t-o,n)}setUint16(t,n,r){this._internalBuffer.setUint16(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1))}setUint32(t,n,r){this._internalBuffer.setUint32(0,n,r),this.setUint8(t,this._internalBuffer.getUint8(0)),this.setUint8(t+1,this._internalBuffer.getUint8(1)),this.setUint8(t+2,this._internalBuffer.getUint8(2)),this.setUint8(t+3,this._internalBuffer.getUint8(3))}setUint8(t,n){const[r,o]=this._findDataViewWithOffset(t);r.setUint8(t-o,n)}_findDataViewWithOffset(t){let n=0;for(const r of this._dataViews){const o=n+r.byteLength;if(t>=n&&t<o)return[r,n];n=o}throw new RangeError}}const Pi=(e,t,n,r,o)=>(s,a,c,i)=>{const u=c.getAudioTracks(),d=[],l=u.length===0?void 0:u[0].getSettings().channelCount,h=new a(c,{mimeType:"audio/webm;codecs=pcm"}),m=u.length===0?void 0:u[0].getSettings().sampleRate;let f=null,p=()=>{};const g=_=>{s.dispatchEvent(e("dataavailable",{data:new Blob(_,{type:i})}))},v=async(_,M)=>{const E=await Ke(_,M);h.state==="inactive"?d.push(...E):(g(E),f=v(_,M))},w=()=>{h.state!=="inactive"&&(f!==null&&(f.catch(()=>{}),f=null),p(),p=()=>{},h.stop())};return h.addEventListener("error",()=>{w(),s.dispatchEvent(new ErrorEvent("error",{error:t()}))}),h.addEventListener("start",()=>s.dispatchEvent(new Event("start"))),{get mimeType(){return i},get state(){return h.state},pause(){return h.pause()},resume(){return h.resume()},start(_){if(c.getVideoTracks().length>0)throw n();if(h.state==="inactive"){if(m===void 0)throw new Error("The sampleRate is not defined.");let M=!1,E=!1,A=0,b=Dn(i,m);p=()=>{E=!0};const y=jn(h,"dataavailable")(({data:R})=>{A+=1,b=b.then(async({dataView:I=null,elementType:N=null,encoderId:P,port:L})=>{const D=await R.arrayBuffer();A-=1;const B=I===null?new Tt([D]):new Tt([...I.buffers,D],I.byteOffset);if(!M&&h.state==="recording"&&!E){const C=o(B,0);if(C===null)return{dataView:B,elementType:N,encoderId:P,port:L};const{value:W}=C;if(W!==172351395)return{dataView:I,elementType:N,encoderId:P,port:L};M=!0}const{currentElementType:U,offset:x,contents:k}=r(B,N,l),S=x<B.byteLength?new Tt(B.buffers,B.byteOffset+x):null;return k.forEach(C=>L.postMessage(C,C.map(({buffer:W})=>W))),A===0&&(h.state==="inactive"||E)&&(Ke(P,null).then(C=>{g([...d,...C]),d.length=0,s.dispatchEvent(new Event("stop"))}),L.postMessage([]),L.close(),y()),{dataView:S,elementType:U,encoderId:P,port:L}})});_!==void 0&&b.then(({encoderId:R})=>f=v(R,_))}h.start(100)},stop:w}},Bi=()=>typeof window>"u"?null:window,Nr=(e,t)=>{if(t>=e.byteLength)return null;const n=e.getUint8(t);if(n>127)return 1;if(n>63)return 2;if(n>31)return 3;if(n>15)return 4;if(n>7)return 5;if(n>3)return 6;if(n>1)return 7;if(n>0)return 8;const r=Nr(e,t+1);return r===null?null:r+8},xi=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof t=="function"?t.call(e,n):t.handleEvent.call(e,n)},Rr=[],mt=Bi(),Di=ro(mt),Sr=Zr(Di),Wi=Li(Sr,xt,eo,ot),Zt=co(Nr),Vi=ao(Zt),ji=io(Zt),Fi=Kr(Vi,ji),$i=Pi(Sr,xt,ot,Fi,Zt),qi=Jr(mt),Gi=so(mt),zi=oo(xt,ot),Xi=no(zi,ot,Wi,$i,Rr,Qr(qi,xi),Gi),Hi=()=>to(mt),Yi=async e=>{Rr.push(await Yr(e))},Zi=Object.freeze(Object.defineProperty({__proto__:null,MediaRecorder:Xi,isSupported:Hi,register:Yi},Symbol.toStringTag,{value:"Module"})),Ki=In(Zi),Qi=Bn({characterize:({call:e})=>()=>e("characterize"),encode:({call:e})=>(t,n)=>e("encode",{recordingId:t,timeslice:n}),record:({call:e})=>async(t,n,r)=>{await e("record",{recordingId:t,sampleRate:n,typedArrays:r},r.map(({buffer:o})=>o).filter(o=>o instanceof ArrayBuffer))}}),Ji=e=>{const t=new Worker(e);return Qi(t)},ec=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,s=536870912,a=2*s,o=function(e,t){return function(r){var o=t.get(r),i=void 0===o?r.size:o<a?o+1:0;if(!r.has(i))return e(r,i);if(r.size<s){for(;r.has(i);)i=Math.floor(Math.random()*a);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),l=o(c,i),u=t(l);e.addUniqueNumber=u,e.generateUniqueNumber=l}(t)}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,s=(e,t)=>Object.assign(new Error(e),{status:t}),a=t=>s('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),o=(t,r)=>async({data:{id:o,method:i,params:c}})=>{const l=r[i];try{if(void 0===l)throw(e=>s('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?l():l(c);if(void 0===r)throw(t=>s('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const u=r instanceof Promise?await r:r;if(null===o){if(void 0!==u.result)throw a(i)}else{if(void 0===u.result)throw a(i);const{result:e,transferables:r=[]}=u;t.postMessage({id:o,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:o})}};var i=r(455);const c=new Map,l=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),s=(0,i.generateUniqueNumber)(c);return c.set(s,()=>{n(),t.close(),c.delete(s)}),{result:s}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>s('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),u=(e,t,r=()=>!0)=>{const n=l(u,t,r),s=o(e,n);return e.addEventListener("message",s),()=>e.removeEventListener("message",s)},d=e=>e.reduce((e,t)=>e+t.length,0),h=(e,t)=>{const r=[];let n=0;e:for(;n<t;){const t=e.length;for(let s=0;s<t;s+=1){const t=e[s];void 0===r[s]&&(r[s]=[]);const a=t.shift();if(void 0===a)break e;r[s].push(a),0===s&&(n+=a.length)}}if(n>t){const s=n-t;r.forEach((t,r)=>{const n=t.pop(),a=n.length-s;t.push(n.subarray(0,a)),e[r].unshift(n.subarray(a))})}return r},f=new Map,m=(e=>(t,r,n)=>{const s=e.get(t);if(void 0===s){const s={channelDataArrays:n.map(e=>[e]),isComplete:!0,sampleRate:r};return e.set(t,s),s}return s.channelDataArrays.forEach((e,t)=>e.push(n[t])),s})(f),p=((e,t)=>(r,n,s,a)=>{const o=s>>3,i="subsequent"===n?0:44,c=r.length,l=e(r[0]),u=new ArrayBuffer(l*c*o+i),d=new DataView(u);return"subsequent"!==n&&t(d,s,c,"complete"===n?l:Number.POSITIVE_INFINITY,a),r.forEach((e,t)=>{let r=i+t*o;e.forEach(e=>{const t=e.length;for(let n=0;n<t;n+=1){const t=e[n];d.setInt16(r,t<0?32768*Math.max(-1,t):32767*Math.min(1,t),!0),r+=c*o}})}),[u]})(d,(e,t,r,n,s)=>{const a=t>>3,o=Math.min(n*r*a,4294967251);e.setUint32(0,1380533830),e.setUint32(4,o+36,!0),e.setUint32(8,1463899717),e.setUint32(12,1718449184),e.setUint32(16,16,!0),e.setUint16(20,1,!0),e.setUint16(22,r,!0),e.setUint32(24,s,!0),e.setUint32(28,s*r*a,!0),e.setUint16(32,r*a,!0),e.setUint16(34,t,!0),e.setUint32(36,1684108385),e.setUint32(40,o,!0)}),v=new Map;u(self,{characterize:()=>({result:/^audio\\/wav$/}),encode:({recordingId:e,timeslice:t})=>{const r=v.get(e);void 0!==r&&(v.delete(e),r.reject(new Error("Another request was made to initiate an encoding.")));const n=f.get(e);if(null!==t){if(void 0===n||d(n.channelDataArrays[0])*(1e3/n.sampleRate)<t)return new Promise((r,n)=>{v.set(e,{reject:n,resolve:r,timeslice:t})});const r=h(n.channelDataArrays,Math.ceil(t*(n.sampleRate/1e3))),s=p(r,n.isComplete?"initial":"subsequent",16,n.sampleRate);return n.isComplete=!1,{result:s,transferables:s}}if(void 0!==n){const t=p(n.channelDataArrays,n.isComplete?"complete":"subsequent",16,n.sampleRate);return f.delete(e),{result:t,transferables:t}}return{result:[],transferables:[]}},record:({recordingId:e,sampleRate:t,typedArrays:r})=>{const n=m(e,t,r),s=v.get(e);if(void 0!==s&&d(n.channelDataArrays[0])*(1e3/t)>=s.timeslice){const r=h(n.channelDataArrays,Math.ceil(s.timeslice*(t/1e3))),a=p(r,n.isComplete?"initial":"subsequent",16,t);n.isComplete=!1,v.delete(e),s.resolve({result:a,transferables:a})}return{result:null}}})})()})();`,tc=new Blob([ec],{type:"application/javascript; charset=utf-8"}),Or=URL.createObjectURL(tc),Ie=Ji(Or),nc=Ie.characterize,rc=Ie.connect,oc=Ie.disconnect,sc=Ie.encode,ac=Ie.isSupported,ic=Ie.record;URL.revokeObjectURL(Or);const cc=Object.freeze(Object.defineProperty({__proto__:null,characterize:nc,connect:rc,disconnect:oc,encode:sc,isSupported:ac,record:ic},Symbol.toStringTag,{value:"Module"})),uc=In(cc);var Sn;function lc(){return Sn||(Sn=1,(function(e){var t=we&&we.__awaiter||function(u,d,l,h){function m(f){return f instanceof l?f:new l(function(p){p(f)})}return new(l||(l=Promise))(function(f,p){function g(_){try{w(h.next(_))}catch(M){p(M)}}function v(_){try{w(h.throw(_))}catch(M){p(M)}}function w(_){_.done?f(_.value):m(_.value).then(g,v)}w((h=h.apply(u,d||[])).next())})},n=we&&we.__generator||function(u,d){var l={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},h,m,f,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(w){return function(_){return v([w,_])}}function v(w){if(h)throw new TypeError("Generator is already executing.");for(;l;)try{if(h=1,m&&(f=w[0]&2?m.return:w[0]?m.throw||((f=m.return)&&f.call(m),0):m.next)&&!(f=f.call(m,w[1])).done)return f;switch(m=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return l.label++,{value:w[1],done:!1};case 5:l.label++,m=w[1],w=[0];continue;case 7:w=l.ops.pop(),l.trys.pop();continue;default:if(f=l.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){l=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){l.label=w[1];break}if(w[0]===6&&l.label<f[1]){l.label=f[1],f=w;break}if(f&&l.label<f[2]){l.label=f[2],l.ops.push(w);break}f[2]&&l.ops.pop(),l.trys.pop();continue}w=d.call(u,l)}catch(_){w=[6,_],m=0}finally{h=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReactMediaRecorder=e.useReactMediaRecorder=e.RecorderErrors=void 0;var r=Ki,o=Ir(),s=uc,a;(function(u){u.AbortError="media_aborted",u.NotAllowedError="permission_denied",u.NotFoundError="no_specified_media_found",u.NotReadableError="media_in_use",u.OverconstrainedError="invalid_media_constraints",u.TypeError="no_constraints",u.NONE="",u.NO_RECORDER="recorder_error"})(a=e.RecorderErrors||(e.RecorderErrors={}));function c(u){var d=this,l=u.audio,h=l===void 0?!0:l,m=u.video,f=m===void 0?!1:m,p=u.selfBrowserSurface,g=p===void 0?void 0:p,v=u.preferCurrentTab,w=v===void 0?!1:v,_=u.onStop,M=_===void 0?function(){return null}:_,E=u.onStart,A=E===void 0?function(){return null}:E,b=u.blobPropertyBag,y=u.screen,R=y===void 0?!1:y,I=u.mediaRecorderOptions,N=I===void 0?void 0:I,P=u.customMediaStream,L=P===void 0?null:P,D=u.stopStreamsOnStop,B=D===void 0?!0:D,U=u.askPermissionOnMount,x=U===void 0?!1:U,k=(0,o.useRef)(null),S=(0,o.useRef)([]),C=(0,o.useRef)(null),W=(0,o.useState)("idle"),G=W[0],H=W[1],ae=(0,o.useState)(!1),ue=ae[0],$=ae[1],Z=(0,o.useState)(void 0),le=Z[0],Te=Z[1],Ce=(0,o.useState)("NONE"),qe=Ce[0],Me=Ce[1],Ge=(0,o.useState)(!1),gt=Ge[0],T=Ge[1];(0,o.useEffect)(function(){if(!gt){var X=function(){return t(d,void 0,void 0,function(){var j;return n(this,function(Y){switch(Y.label){case 0:return Y.trys.push([0,3,,4]),j=r.register,[4,(0,s.connect)()];case 1:return[4,j.apply(void 0,[Y.sent()])];case 2:return Y.sent(),[3,4];case 3:return Y.sent(),[3,4];case 4:return[2]}})})};X(),T(!0)}},[]);var O=(0,o.useCallback)(function(){return t(d,void 0,void 0,function(){var X,j,Y,de,ze;return n(this,function(ie){switch(ie.label){case 0:H("acquiring_media"),X={audio:typeof h=="boolean"?!!h:h,video:typeof f=="boolean"?!!f:f},ie.label=1;case 1:return ie.trys.push([1,9,,10]),L?(C.current=L,[3,8]):[3,2];case 2:return R?[4,window.navigator.mediaDevices.getDisplayMedia({video:f||!0,selfBrowserSurface:g,preferCurrentTab:w})]:[3,6];case 3:return j=ie.sent(),j.getVideoTracks()[0].addEventListener("ended",function(){Ne()}),h?[4,window.navigator.mediaDevices.getUserMedia({audio:h})]:[3,5];case 4:Y=ie.sent(),Y.getAudioTracks().forEach(function(kr){return j.addTrack(kr)}),ie.label=5;case 5:return C.current=j,[3,8];case 6:return[4,window.navigator.mediaDevices.getUserMedia(X)];case 7:de=ie.sent(),C.current=de,ie.label=8;case 8:return H("idle"),[3,10];case 9:return ze=ie.sent(),Me(ze.name),H("idle"),[3,10];case 10:return[2]}})})},[h,f,R]);(0,o.useEffect)(function(){if(!window.MediaRecorder)throw new Error("Unsupported Browser");if(R&&!window.navigator.mediaDevices.getDisplayMedia)throw new Error("This browser doesn't support screen capturing");var X=function(j){var Y=navigator.mediaDevices.getSupportedConstraints(),de=Object.keys(j).filter(function(ze){return!Y[ze]});de.length>0&&console.error("The constraints "+de.join(",")+" doesn't support on this browser. Please check your ReactMediaRecorder component.")};return typeof h=="object"&&X(h),typeof f=="object"&&X(f),N&&N.mimeType&&(MediaRecorder.isTypeSupported(N.mimeType)||console.error("The specified MIME type you supplied for MediaRecorder doesn't support this browser")),!C.current&&x&&O(),function(){if(C.current){var j=C.current.getTracks();j.forEach(function(Y){return Y.clone().stop()})}}},[h,R,f,O,N,x]);var z=function(){return t(d,void 0,void 0,function(){var X;return n(this,function(j){switch(j.label){case 0:return Me("NONE"),C.current?[3,2]:[4,O()];case 1:j.sent(),j.label=2;case 2:return C.current?(X=C.current.getTracks().some(function(Y){return Y.readyState==="ended"}),X?[4,O()]:[3,4]):[3,5];case 3:j.sent(),j.label=4;case 4:if(!C.current.active)return[2];k.current=new r.MediaRecorder(C.current,N||void 0),k.current.ondataavailable=F,k.current.onstop=q,k.current.onstart=V,k.current.onerror=function(){Me("NO_RECORDER"),H("idle")},k.current.start(),H("recording"),j.label=5;case 5:return[2]}})})},F=function(X){var j=X.data;S.current.push(j)},V=function(){A()},q=function(){var X=S.current[0],j=Object.assign({type:X.type},b||(f?{type:"video/mp4"}:{type:"audio/wav"})),Y=new Blob(S.current,j),de=URL.createObjectURL(Y);H("stopped"),Te(de),M(de,Y)},K=function(X){$(X),C.current&&C.current.getAudioTracks().forEach(function(j){return j.enabled=!X})},re=function(){k.current&&k.current.state==="recording"&&(H("paused"),k.current.pause())},ve=function(){k.current&&k.current.state==="paused"&&(H("recording"),k.current.resume())},Ne=function(){k.current&&k.current.state!=="inactive"&&(H("stopping"),k.current.stop(),B&&C.current&&C.current.getTracks().forEach(function(X){return X.stop()}),S.current=[])};return{error:a[qe],muteAudio:function(){return K(!0)},unMuteAudio:function(){return K(!1)},startRecording:z,pauseRecording:re,resumeRecording:ve,stopRecording:Ne,mediaBlobUrl:le,status:G,isAudioMuted:ue,previewStream:C.current?new MediaStream(C.current.getVideoTracks()):null,previewAudioStream:C.current?new MediaStream(C.current.getAudioTracks()):null,clearBlobUrl:function(){le&&URL.revokeObjectURL(le),Te(void 0),H("idle")}}}e.useReactMediaRecorder=c;var i=function(u){return u.render(c(u))};e.ReactMediaRecorder=i})(we)),we}var Ct,On;function dc(){return On||(On=1,Ct=lc()),Ct}var fc=dc();function jc(e){const{status:t,startRecording:n,stopRecording:r,mediaBlobUrl:o,previewStream:s}=fc.useReactMediaRecorder({video:!0,audio:!1}),[a,c]=vt.useState(!1);return vt.useEffect(()=>(n(),()=>{t==="recording"&&r()}),[]),vt.useEffect(()=>{o!=null&&(console.log("START"),fetch(o).then(i=>i.blob()).then(i=>{const u="media_file.mp4",d=i.type,l=new File([i],u,{type:d});e.onSend(l)}))},[o]),J.jsxs(Ur,{mih:"100vh",gap:0,children:[J.jsx(Lr,{align:"center",justify:"center",children:J.jsxs(Kt,{order:4,children:["Take a picture of your surroundings"," ",J.jsx(Qt,{onClick:()=>c(!0),variant:"subtle",size:"lg",p:0,children:"(Why?)"})]})}),J.jsx(Pr,{shadow:"md",padding:0,mb:wt(20),mx:wt(10),bdrs:wt(10),bg:"#f8fafc",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:t==="recording"&&s?J.jsx("video",{ref:i=>{i&&s&&(i.srcObject=s)},style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:16},autoPlay:!0,muted:!0,playsInline:!0}):J.jsx(_t,{children:"Preparing camera…"})}),J.jsx("div",{style:{padding:"12px 16px",background:"transparent"},children:J.jsx(Qt,{onClick:r,loading:t!=="recording",fullWidth:!0,size:"lg",children:"Take Photo"})}),J.jsxs(Br,{opened:a,onClose:()=>c(!1),children:[J.jsx(Kt,{order:1,children:"Why request a picture in a sign-in app?"}),J.jsx(_t,{children:`If you took longer than 10 seconds to open this page after scanning the QR code, you'll get this. QR codes "expire" every 10 seconds to prevent people from sending sign-in links to their friends.`}),J.jsx(_t,{children:"Once they expire, we make you send a photo of yourself to make sure that you're on CA campus and not somewhere else."})]})]})}export{jc as default};
