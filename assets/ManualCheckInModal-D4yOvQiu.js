import{j as e,r as c}from"./index-BqTru8hP.js";import{a as y}from"./perms-Ci-WEFVW.js";import{a as I,u as S,b as k,B as v,c as N,g as l,f as C}from"./fetchBackend-C9uYacD6.js";import{S as M}from"./SignInButton-wuizvn64.js";import{k as O,O as T,M as D}from"./Modal-Bib_5y26.js";import{C as P}from"./Center-BkokBDOu.js";import{B as m}from"./Button-Ce4tf8zp.js";import{T as f}from"./Title-CKNj1X-Y.js";import{T as A}from"./TextInput-fgqT366L.js";import"./CloseButton-CZ-4pOrX.js";import"./UnstyledButton-rzi-lcRA.js";import"./Paper-BqMcMbvK.js";import"./tslib.es6-BDktPqig.js";var p={root:"m_7f854edf"};const B={position:{bottom:0,right:0},zIndex:O("modal"),withinPortal:!0},z=N((o,{zIndex:n,position:t})=>({root:{"--affix-z-index":n?.toString(),"--affix-top":l(t?.top),"--affix-left":l(t?.left),"--affix-bottom":l(t?.bottom),"--affix-right":l(t?.right)}})),u=I((o,n)=>{const t=S("Affix",B,o),{classNames:i,className:d,style:s,styles:r,unstyled:a,vars:h,portalProps:x,zIndex:F,withinPortal:g,position:R,attributes:b,...j}=t,w=k({name:"Affix",classes:p,props:t,className:d,style:s,classNames:i,styles:r,unstyled:a,attributes:b,vars:h,varsResolver:z});return e.jsx(T,{...x,withinPortal:g,children:e.jsx(v,{ref:n,...w("root"),...j})})});u.classes=p;u.displayName="@mantine/core/Affix";function X(o){const[n,t]=c.useState(!1),[i,d]=c.useState(""),s=y({queryKey:["manualCheckIn"],queryFn:async()=>{const r=parseInt(i);if(Number.isNaN(r))return window.alert("Invalid student ID"),!1;const a=await C("/checkin/runManual/",{method:"POST",credentials:"include",body:JSON.stringify({student_id:r})});switch(a.status){case 400:return window.alert("Invalid Student ID."),null;case 401:return window.alert("Dev error: insufficient perms(bruH)"),null;case 405:return window.alert("There are no free blocks to sign in to."),null;case 200:return(await a.json()).studentName;default:return window.alert("LMAO unknown error: "+a.status),null}},enabled:!1});return e.jsxs(e.Fragment,{children:[e.jsx(u,{bottom:200,w:"100%",display:o.perms?.teacherMonitored?void 0:"none",children:e.jsx(P,{children:e.jsx(m,{bg:"red",size:"lg",onClick:()=>t(!0),children:"Don't have a phone?"})})}),e.jsx(D,{opened:n,onClose:()=>t(!1),children:s.data?e.jsxs(e.Fragment,{children:[e.jsxs(f,{mb:30,children:["Thanks for signing in, ",s.data,"!"]}),e.jsx(m,{onClick:()=>t(!1),children:"Ok"})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{mb:30,children:"Sign in manually"}),e.jsxs("form",{onSubmit:()=>s.refetch(),children:[e.jsx(A,{value:i,onChange:r=>d(r.target.value),placeholder:"Student ID(The numbers on your ID card)",size:"lg",radius:12,mb:20}),e.jsx(M,{submitting:s.isFetching})]})]})})]})}export{X as default};
