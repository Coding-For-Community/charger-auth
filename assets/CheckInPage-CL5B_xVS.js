const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SnapEvidence-DEipjsYA.js","assets/index-CpXPMzny.js","assets/index-DlEsbloS.css","assets/Stack-2hmfsRr8.js","assets/polymorphic-factory-DVFjMKD1.js","assets/Group-Ch5u0LQ6.js","assets/Title-Dnu4jDSz.js","assets/Button-ByeRv-_m.js","assets/perms-Ddz5bMJb.js","assets/fetchBackend-CVLyjmH-.js","assets/UnstyledButton-B23gwzJf.js","assets/Card-DUyCxxw2.js","assets/Paper-BL30-VgI.js","assets/FocusTrap-DtoqOGiO.js","assets/Text-CZSeUXcN.js","assets/Modal-BG_K7mnE.js","assets/CloseButton-C4Is_nua.js","assets/icons-DUMop_vW.js","assets/ModeSelect-DY5MN84J.js","assets/Select-CmmcsgRo.js","assets/InputBase-3hnoAzNJ.js"])))=>i.map(i=>d[i]);
import{r as t,h as S,j as e,L as x,_ as p}from"./index-CpXPMzny.js";import{u as w,a as v,c as f}from"./checkIn-1BYCYZD5.js";import{b as _,L as T}from"./perms-Ddz5bMJb.js";import{b,c as E}from"./icons-DUMop_vW.js";import{T as m}from"./Title-Dnu4jDSz.js";import{T as l}from"./Text-CZSeUXcN.js";import{S as y}from"./Stack-2hmfsRr8.js";import"./fetchBackend-CVLyjmH-.js";import"./polymorphic-factory-DVFjMKD1.js";const L=t.lazy(()=>p(()=>import("./SnapEvidence-DEipjsYA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),R=t.lazy(()=>p(()=>import("./ModeSelect-DY5MN84J.js"),__vite__mapDeps([18,1,2,19,20,4,16,10,13,7,8,9,3,14])));function V(){const u=t.useRef(new Date().getTime()),[r,i]=t.useState({status:"loading"}),[c,g]=t.useState(void 0),[a,k]=t.useState(void 0),{email:h}=_(),{kioskToken:j}=S.useSearch(),n=w(j),s=v();function d(){if(!(s.data==null||n.data==null)){if(n.data===0){if(a==null)return;f(h,s.data,c,void 0,a).then(i)}else f(h,s.data,c,n.data).then(i);i({status:"loading"})}}if(t.useEffect(()=>(d(),window.addEventListener("hashchange",d),()=>window.removeEventListener("hashchange",d)),[s.data,n.data,a,c]),n.data===0&&!a)return e.jsx(L,{onSend:k});let o=e.jsx(e.Fragment,{});switch(r.status){case"loading":o=e.jsxs(e.Fragment,{children:[e.jsx(T,{size:"xl",mb:"md"}),e.jsx(m,{order:3,ta:"center",mb:"xs",children:"Checking you in..."}),e.jsx(l,{ta:"center",c:"dimmed",children:"Please wait while we verify your information and check you in."})]});break;case"ok":o=e.jsxs(e.Fragment,{children:[e.jsx(E,{size:48,color:"green"}),e.jsx(m,{order:3,ta:"center",mt:"md",mb:"xs",children:"Check-in Successful!"}),e.jsxs(l,{ta:"center",c:"dimmed",mb:"md",children:["Thanks for checking in",r.studentName?`, ${r.studentName}`:"","!"]}),e.jsx(x,{to:"/",search:{cooldownStartMs:u.current},children:"Return to home page"})]});break;case"err":o=e.jsxs(e.Fragment,{children:[e.jsx(b,{size:48,color:"#fa5252"}),e.jsx(m,{order:3,ta:"center",mt:"md",c:"#fa5252",children:"Check-in Failed"}),e.jsx(l,{ta:"center",c:"dimmed",mb:"md",style:{whiteSpace:"pre-wrap"},children:r.msg?.trim()??"An unknown error occurred. Please try again."}),e.jsx(x,{to:"/",search:{cooldownStartMs:u.current},children:"Return to home page"})]});break;case"modeNeeded":return e.jsx(R,{onSelect:g})}return e.jsx(y,{justify:"center",align:"center",mih:"100vh",gap:0,p:"md",children:o})}export{V as component};
