const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SnapEvidence-Bp2FdL-D.js","assets/index-D-hz2KRy.js","assets/index-DlEsbloS.css","assets/Stack-B7PzWi6w.js","assets/polymorphic-factory-GxGHriZZ.js","assets/Group-9e3y5f4E.js","assets/Title-DrgCdA7e.js","assets/Button-DdsH8_yP.js","assets/perms-VdFrCTKL.js","assets/fetchBackend-CVLyjmH-.js","assets/UnstyledButton-rQ28b0ST.js","assets/Card-u10_GD_N.js","assets/Paper-BslVBRtG.js","assets/FocusTrap-3w-axlIr.js","assets/Text-mkyFJXSW.js","assets/Modal-DK0l-2aK.js","assets/CloseButton-CrY9a_Wa.js","assets/icons-1umIfrk-.js","assets/ModeSelect-CiGSrTc5.js","assets/Select-DJ8T0P-C.js","assets/InputBase-C5vHkoN5.js"])))=>i.map(i=>d[i]);
import{r as t,h as k,j as e,L as h,_ as g}from"./index-D-hz2KRy.js";import{u as S,a as w,c as x}from"./checkIn-BCKRiTWV.js";import{b as v,L as _}from"./perms-VdFrCTKL.js";import{b,c as T}from"./icons-1umIfrk-.js";import{T as m}from"./Title-DrgCdA7e.js";import{T as u}from"./Text-mkyFJXSW.js";import{S as E}from"./Stack-B7PzWi6w.js";import"./fetchBackend-CVLyjmH-.js";import"./polymorphic-factory-GxGHriZZ.js";const L=t.lazy(()=>g(()=>import("./SnapEvidence-Bp2FdL-D.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),y=t.lazy(()=>g(()=>import("./ModeSelect-CiGSrTc5.js"),__vite__mapDeps([18,1,2,19,20,4,16,10,13,7,8,9,3,14])));function N(){const[s,i]=t.useState({status:"loading"}),[c,p]=t.useState(void 0),[n,f]=t.useState(void 0),{email:l}=v(),{kioskToken:j}=k.useSearch(),r=S(j),a=w();function d(){if(!(s.status==="ok"||!a.isSuccess||!r.isSuccess)){if(r.data===0){if(n==null)return;x(l,a.data,c,void 0,n).then(i)}else x(l,a.data,c,r.data).then(i);i({status:"loading"})}}if(t.useEffect(()=>(d(),window.addEventListener("hashchange",d),()=>window.removeEventListener("hashchange",d)),[a.isSuccess,r.isSuccess,n,c]),r.data===0&&!n)return e.jsx(L,{onSend:f});let o=e.jsx(e.Fragment,{});switch(s.status){case"loading":o=e.jsxs(e.Fragment,{children:[e.jsx(_,{size:"xl",mb:"md"}),e.jsx(m,{order:3,ta:"center",mb:"xs",children:"Checking you in..."}),e.jsx(u,{ta:"center",c:"dimmed",children:"Please wait while we verify your information and check you in."})]});break;case"ok":o=e.jsxs(e.Fragment,{children:[e.jsx(T,{size:48,color:"green"}),e.jsx(m,{order:3,ta:"center",mt:"md",mb:"xs",children:"Check-in Successful!"}),e.jsxs(u,{ta:"center",c:"dimmed",mb:"md",children:["Thanks for checking in",s.studentName?`, ${s.studentName}`:"","! ",e.jsx("br",{}),new Date().toLocaleString()," ",e.jsx("br",{})]}),e.jsx(h,{to:"/",search:{cooldownStartMs:new Date().getTime()},children:"Return to home page"})]});break;case"err":o=e.jsxs(e.Fragment,{children:[e.jsx(b,{size:48,color:"#fa5252"}),e.jsx(m,{order:3,ta:"center",mt:"md",c:"#fa5252",children:"Check-in Failed"}),e.jsx(u,{ta:"center",c:"dimmed",mb:"md",style:{whiteSpace:"pre-wrap"},children:s.msg?.trim()??"An unknown error occurred. Please try again."}),e.jsx(h,{to:"/",search:{cooldownStartMs:null},children:"Return to home page"})]});break;case"modeNeeded":return e.jsx(y,{onSelect:p})}return e.jsx(E,{justify:"center",align:"center",mih:"100vh",gap:0,p:"md",children:o})}export{N as component};
