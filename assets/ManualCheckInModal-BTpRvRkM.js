import{r as a,C as h,j as e}from"./index-DfduYSoD.js";import{a as x}from"./perms-plF_VzWY.js";import{f as g}from"./fetchBackend-DXiCz5vF.js";import{S as j}from"./SignInButton-B_kAYEu3.js";import{p as S}from"./checkIn-DVYt2UcR.js";import{ModeSelectComponent as y}from"./ModeSelect-C1C_p9qg.js";import{c as I}from"./icons-BribBizY.js";import{M as b}from"./Modal-DX1v07Y5.js";import{S as k}from"./Stack-D6Re_kW6.js";import{T as l}from"./Title-v-no_6ht.js";import{B as C}from"./Button-D0_HBRYe.js";import{T as w}from"./TextInput-BKesORwk.js";import"./Select-CBjoK-Vo.js";import"./InputBase-Cd3f_o6w.js";import"./CloseButton-C5DEhKNx.js";import"./UnstyledButton-CQzcWRE4.js";import"./FocusTrap-jhG-eGaZ.js";import"./Text-WWLSt1wR.js";import"./Paper-MaLJMJoM.js";import"./use-window-event-DarO5gh9.js";function U(o){const[s,i]=a.useState(""),[u,d]=a.useState("free_period"),[c,p]=a.useState(!1),f=h(),r=x({queryKey:["manualCheckIn"],queryFn:async()=>{if(s==="")return;p(!1);const t=parseInt(s);if(Number.isNaN(t))return window.alert("Invalid student ID"),!1;const n=await S(await g("/checkin/runManual/",{method:"POST",credentials:"include",body:JSON.stringify({student_id:t,mode:u})}));if(n.status==="ok")return n.studentName;if(n.status==="err")return window.alert(n.msg),null},enabled:!1});function m(){o.setOpen(!1),f.resetQueries({queryKey:["manualCheckIn"]}),i("")}return e.jsx(e.Fragment,{children:e.jsx(b,{opened:o.open,onClose:m,children:r.data&&!c?e.jsxs(k,{align:"center",justify:"center",gap:20,children:[e.jsx(I,{color:"green",size:100,style:M}),e.jsxs(l,{ta:"center",children:[r.data," just signed in."]}),e.jsx(C,{onClick:m,w:"100%",radius:12,children:"Ok"})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{mb:20,children:"Sign in manually"}),e.jsxs("form",{onSubmit:()=>r.refetch(),children:[e.jsx(w,{value:s,onChange:t=>i(t.target.value),placeholder:"Enter your student ID",size:"lg",radius:12,mb:20}),e.jsx(y,{value:u,onChange:t=>t&&d(t),mb:20,labelProps:{size:"sm"}}),e.jsx(j,{submitting:r.isFetching})]})]})})})}const M={marginTop:20,zIndex:3,transition:"transform 0.2s",boxShadow:"0 4px 24px rgba(0,0,0,0.15)",background:"white",borderRadius:"50%",padding:12};export{U as default};
