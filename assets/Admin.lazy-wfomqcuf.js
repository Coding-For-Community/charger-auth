const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EvidencePlayer-CeKFpFfa.js","assets/index-DH33yCP3.js","assets/index-DlEsbloS.css","assets/fetchBackend-BvYIy6Ce.js","assets/Modal-DspYfBUm.js","assets/FocusTrap-C9n1Mqy4.js","assets/Button-B9phEPsS.js","assets/perms-BCD6UpmF.js","assets/UnstyledButton-BYBMPo6c.js","assets/CloseButton-Ct5Xt147.js","assets/Paper-BF1sUadE.js","assets/use-window-event-D8TADfwR.js","assets/icons-Dtl_YfcB.js","assets/Title-B6ucIM_M.js","assets/Group-_ul_hltj.js","assets/Center-BJZG3K1g.js"])))=>i.map(i=>d[i]);
import{r as w,j as e,p as ne,g as A,a as ae,c as _e,b as x,_ as Se}from"./index-DH33yCP3.js";import{u as Ie,a as se,L as Re}from"./perms-BCD6UpmF.js";import{u as O,B as I,g as M,a as Pe,b as B,c as V,d as Q,e as q,h as Te,f as E}from"./fetchBackend-BvYIy6Ce.js";import{I as Ne,a as ze}from"./icons-Dtl_YfcB.js";import{G as N}from"./Group-_ul_hltj.js";import{T as z}from"./Title-B6ucIM_M.js";import{A as L,a as te}from"./AppShell-nhm7VoJc.js";import{c as Fe,u as Ae,C as Oe}from"./CloseButton-Ct5Xt147.js";import{u as ce,C as ie,S as Be}from"./Select-L5KYlNaw.js";import{T as Ve}from"./TextInput-DHPDchWZ.js";import{T as Y}from"./Text-DdwNvlmI.js";import{S as $e}from"./Stack-gHWCX3XE.js";import{B as re}from"./Button-B9phEPsS.js";import{P as le}from"./Paper-BF1sUadE.js";import{S as Ge}from"./FocusTrap-C9n1Mqy4.js";import{I as W,u as Le}from"./InputBase-1hmZZ60y.js";import{U as De}from"./UnstyledButton-BYBMPo6c.js";import"./use-window-event-D8TADfwR.js";function de(o,s){return typeof o=="boolean"?o:s.autoContrast}var ue={root:"m_5f75b09e",body:"m_5f6e695e",labelWrapper:"m_d3ea56bb",label:"m_8ee546b8",description:"m_328f68c0",error:"m_8e8a99cc"};const Ee=ue,he=w.forwardRef(({__staticSelector:o,__stylesApiProps:s,className:t,classNames:i,styles:l,unstyled:r,children:d,label:n,description:m,id:v,disabled:u,error:h,size:b,labelPosition:y="left",bodyElement:k="div",labelElement:C="label",variant:p,style:g,vars:a,mod:f,attributes:_,...c},S)=>{const j=O({name:o,props:s,className:t,style:g,classes:ue,classNames:i,styles:l,unstyled:r,attributes:_});return e.jsx(I,{...j("root"),ref:S,__vars:{"--label-fz":Pe(b),"--label-lh":M(b,"label-lh")},mod:[{"label-position":y},f],variant:p,size:b,...c,children:e.jsxs(I,{component:k,htmlFor:k==="label"?v:void 0,...j("body"),children:[d,e.jsxs("div",{...j("labelWrapper"),"data-disabled":u||void 0,children:[n&&e.jsx(I,{component:C,htmlFor:C==="label"?v:void 0,...j("label"),"data-disabled":u||void 0,children:n}),m&&e.jsx(W.Description,{size:b,__inheritStyles:!1,...j("description"),children:m}),h&&typeof h!="boolean"&&e.jsx(W.Error,{size:b,__inheritStyles:!1,...j("error"),children:h})]})]})})});he.displayName="@mantine/core/InlineInput";const me=w.createContext(null),We=me.Provider,xe=()=>w.useContext(me),[Me,Qe]=Fe();var be={card:"m_26775b0a"};const Ye={withBorder:!0},qe=Q((o,{radius:s})=>({card:{"--card-radius":q(s)}})),H=B((o,s)=>{const t=V("CheckboxCard",Ye,o),{classNames:i,className:l,style:r,styles:d,unstyled:n,vars:m,checked:v,mod:u,withBorder:h,value:b,onClick:y,defaultChecked:k,onChange:C,attributes:p,...g}=t,a=O({name:"CheckboxCard",classes:be,props:t,className:l,style:r,classNames:i,styles:d,unstyled:n,attributes:p,vars:m,varsResolver:qe,rootSelector:"card"}),f=xe(),_=typeof v=="boolean"?v:f?f.value.includes(b||""):void 0,[c,S]=ce({value:_,defaultValue:k,finalValue:!1,onChange:C});return e.jsx(Me,{value:{checked:c},children:e.jsx(De,{ref:s,mod:[{"with-border":h,checked:c},u],...a("card"),...g,role:"checkbox","aria-checked":c,onClick:j=>{y?.(j),f?.onChange(b||""),S(!c)}})})});H.displayName="@mantine/core/CheckboxCard";H.classes=be;function He({children:o,role:s}){const t=Le();return t?e.jsx("div",{role:s,"aria-labelledby":t.labelId,"aria-describedby":t.describedBy,children:o}):e.jsx(e.Fragment,{children:o})}const U=B((o,s)=>{const{value:t,defaultValue:i,onChange:l,size:r,wrapperProps:d,children:n,readOnly:m,...v}=V("CheckboxGroup",null,o),[u,h]=ce({value:t,defaultValue:i,finalValue:[],onChange:l}),b=y=>{const k=typeof y=="string"?y:y.currentTarget.value;!m&&h(u.includes(k)?u.filter(C=>C!==k):[...u,k])};return e.jsx(We,{value:{value:u,onChange:b,size:r},children:e.jsx(W.Wrapper,{size:r,ref:s,...d,...v,labelElement:"div",__staticSelector:"CheckboxGroup",children:e.jsx(He,{role:"group",children:n})})})});U.classes=W.Wrapper.classes;U.displayName="@mantine/core/CheckboxGroup";var pe={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const Ue={icon:ie},Je=Q((o,{radius:s,color:t,size:i,iconColor:l,variant:r,autoContrast:d})=>{const n=ne({color:t||o.primaryColor,theme:o}),m=n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-outline)`:n.color;return{indicator:{"--checkbox-size":M(i,"checkbox-size"),"--checkbox-radius":s===void 0?void 0:q(s),"--checkbox-color":r==="outline"?m:A(t,o),"--checkbox-icon-color":l?A(l,o):de(d,o)?ae({color:t,theme:o,autoContrast:d}):void 0}}}),J=B((o,s)=>{const t=V("CheckboxIndicator",Ue,o),{classNames:i,className:l,style:r,styles:d,unstyled:n,vars:m,icon:v,indeterminate:u,radius:h,color:b,iconColor:y,autoContrast:k,checked:C,mod:p,variant:g,disabled:a,attributes:f,..._}=t,c=O({name:"CheckboxIndicator",classes:pe,props:t,className:l,style:r,classNames:i,styles:d,unstyled:n,attributes:f,vars:m,varsResolver:Je,rootSelector:"indicator"}),S=Qe(),j=typeof C=="boolean"||typeof u=="boolean"?C||u:S?.checked||!1;return e.jsx(I,{ref:s,...c("indicator",{variant:g}),variant:g,mod:[{checked:j,disabled:a},p],..._,children:e.jsx(v,{indeterminate:u,...c("icon")})})});J.displayName="@mantine/core/CheckboxIndicator";J.classes=pe;var fe={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const Ke={labelPosition:"right",icon:ie},Xe=Q((o,{radius:s,color:t,size:i,iconColor:l,variant:r,autoContrast:d})=>{const n=ne({color:t||o.primaryColor,theme:o}),m=n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-outline)`:n.color;return{root:{"--checkbox-size":M(i,"checkbox-size"),"--checkbox-radius":s===void 0?void 0:q(s),"--checkbox-color":r==="outline"?m:A(t,o),"--checkbox-icon-color":l?A(l,o):de(d,o)?ae({color:t,theme:o,autoContrast:d}):void 0}}}),F=B((o,s)=>{const t=V("Checkbox",Ke,o),{classNames:i,className:l,style:r,styles:d,unstyled:n,vars:m,color:v,label:u,id:h,size:b,radius:y,wrapperProps:k,checked:C,labelPosition:p,description:g,error:a,disabled:f,variant:_,indeterminate:c,icon:S,rootRef:j,iconColor:no,onChange:K,autoContrast:ao,mod:ke,attributes:ve,...ye}=t,$=xe(),ge=b||$?.size,G=O({name:"Checkbox",props:t,classes:fe,className:l,style:r,classNames:i,styles:d,unstyled:n,attributes:ve,vars:m,varsResolver:Xe}),{styleProps:je,rest:X}=Te(ye),Z=Ae(h),ee=$?{checked:$.value.includes(X.value),onChange:oe=>{$.onChange(oe),K?.(oe)}}:{},we=w.useRef(null),T=s||we;return w.useEffect(()=>{T&&"current"in T&&T.current&&(T.current.indeterminate=c||!1)},[c,T]),e.jsx(he,{...G("root"),__staticSelector:"Checkbox",__stylesApiProps:t,id:Z,size:ge,labelPosition:p,label:u,description:g,error:a,disabled:f,classNames:i,styles:d,unstyled:n,"data-checked":ee.checked||C||void 0,variant:_,ref:j,mod:ke,...je,...k,children:e.jsxs(I,{...G("inner"),mod:{"data-label-position":p},children:[e.jsx(I,{component:"input",id:Z,ref:T,checked:C,disabled:f,mod:{error:!!a,indeterminate:c},...G("input",{focusable:!0,variant:_}),onChange:K,...X,...ee,type:"checkbox"}),e.jsx(S,{indeterminate:c,...G("icon")})]})})});F.classes={...fe,...Ee};F.displayName="@mantine/core/Checkbox";F.Group=U;F.Indicator=J;F.Card=H;var Ce={root:"m_3eebeb36",label:"m_9e365f20"};const Ze={orientation:"horizontal"},eo=Q((o,{color:s,variant:t,size:i})=>({root:{"--divider-color":s?A(s,o):void 0,"--divider-border-style":t,"--divider-size":M(i,"divider-size")}})),P=B((o,s)=>{const t=V("Divider",Ze,o),{classNames:i,className:l,style:r,styles:d,unstyled:n,vars:m,color:v,orientation:u,label:h,labelPosition:b,mod:y,attributes:k,...C}=t,p=O({name:"Divider",classes:Ce,props:t,className:l,style:r,classNames:i,styles:d,unstyled:n,attributes:k,vars:m,varsResolver:eo});return e.jsx(I,{ref:s,mod:[{orientation:u,"with-label":!!h},y],...p("root"),...C,role:"separator",children:h&&e.jsx(I,{component:"span",mod:{position:b},...p("label"),children:h})})});P.classes=Ce;P.displayName="@mantine/core/Divider";const So=_e("/Admin")({component:so}),oo=w.lazy(()=>Se(()=>import("./EvidencePlayer-CeKFpFfa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),R="Senior Privileges";function so(){const o=Ie(),[s,t]=w.useState(!1),[i,l]=w.useState(!0),[r,d]=w.useState("A"),[n,m]=w.useState(""),[v,u]=w.useState(()=>{const a=window.localStorage.getItem("checkedItems");return a==null?[]:JSON.parse(a)}),h=se({queryKey:["students",r],queryFn:async()=>await(r===R?await E("/checkin/spStudents/"):await E(`/checkin/students/${r}`)).json()}),b=se({queryKey:["seniorYear"],queryFn:async()=>await(await E("/checkin/seniorYear/")).text(),staleTime:1/0});function y(a){return v.includes(a)}function k(a,f){u(_=>{let c=_;return a?c.includes(f)||(c=c.concat(f)):c=c.filter(S=>S!==f),window.localStorage.setItem("checkedItems",JSON.stringify(c)),c})}function C(a){return n===""||a.name.toLowerCase().includes(n.toLowerCase())||a.id&&a.id.toLowerCase().includes(n.toLowerCase())}function p(a){return h.data?.filter(f=>f.status===a&&C(f))??[]}const g={hasCheckbox:r!==R,checked:y,setChecked:k};return o.isFetching?e.jsxs(N,{justify:"center",align:"center",style:{minHeight:"100vh"},children:[e.jsx(Re,{size:"xl"}),e.jsx(z,{order:3,ml:"md",children:"Loading admin dashboard..."})]}):e.jsxs(L,{padding:"md",header:{height:60},navbar:{width:240,breakpoint:"sm",collapsed:{mobile:i}},style:{background:"#f6f8fa"},children:[e.jsx(L.Header,{p:x(15),style:{background:"#fff",borderBottom:"1px solid #e9ecef"},children:e.jsxs(N,{gap:x(10),children:[e.jsx("img",{src:"icon.svg",width:32,height:32,style:{borderRadius:8}}),e.jsx(z,{order:3,fw:700,c:"blue",children:"CA Check-in Admin"}),e.jsx(te,{variant:"transparent",ml:"auto",hiddenFrom:"sm",onClick:()=>l(!i),children:e.jsx(Ne,{})})]})}),e.jsxs(L.Navbar,{p:"md",style:{background:"#f8fafc",borderRight:"1px solid #e9ecef"},children:[e.jsxs(N,{justify:"space-between",mb:x(8),children:[e.jsx(z,{order:4,c:"gray.7",children:"Options"}),e.jsx(Oe,{hiddenFrom:"sm",onClick:()=>l(!0)})]}),e.jsx(P,{mb:x(12)}),e.jsx(Be,{data:["A","B","C","D","E","F","G",R],value:r,onChange:a=>{a!=null&&d(a)},maw:x(200),label:"Free Period/SP",maxDropdownHeight:300}),e.jsx(Ve,{value:n,onChange:a=>m(a.target.value),placeholder:"Search by name",maw:x(200),label:"Student Search",mt:x(16)}),e.jsx(P,{mt:x(16)}),e.jsxs(N,{gap:x(8),children:[e.jsx(te,{variant:"outline",color:"blue",radius:"lg",onClick:()=>h.refetch(),loading:h.isFetching,children:e.jsx(ze,{size:"20"})}),e.jsx(Y,{size:"sm",c:"gray.6",children:"Reload students"})]}),e.jsx(P,{mb:x(14)}),e.jsxs($e,{gap:x(10),children:[e.jsx(re,{bg:"yellow",onClick:()=>t(!0),children:"Open Tentative Videos"}),e.jsx(re,{bg:"red",onClick:to,children:"Force Reset"})]}),e.jsx(P,{my:x(14)}),e.jsxs(Y,{m:0,c:"gray.6",children:["Senior year: ",b.data??"Fetching..."]})]}),e.jsxs(L.Main,{maw:x(1200),mih:"calc(100vh - 20px)",children:[e.jsxs(z,{order:4,c:"gray.7",mb:x(8),children:["Students with ",r," block free"]}),e.jsx(P,{mb:x(16)}),e.jsxs(N,{align:"flex-start",grow:!0,style:{height:"calc(100vh - 150px)"},children:[e.jsx(D,{title:r===R?"Checked Out":"Checked In",color:"green",students:p(r===R?"checked_out":"checked_in"),...g}),e.jsx(D,{title:r===R?"Tentative(Out)":"Tentative",color:"yellow",students:p("tentative"),...g}),r===R?e.jsx(D,{title:"Tentative(In)",color:"yellow",students:p("tentative_in"),...g}):e.jsx(D,{title:"Absent",color:"red",students:p("nothing"),...g})]})]}),e.jsx(oo,{opened:s,onClose:()=>{h.refetch(),t(!1)},freeBlock:r,students:p("tentative")})]})}async function to(){if(window.prompt("Type 'YES' if you want to force reset.")!=="YES"){window.alert("Operation was cancelled.");return}const s=await E("/checkin/forceReset/",{credentials:"include"});s.ok?window.alert("Reset successful"):window.alert("ERROR: "+s.statusText)}function D(o){return e.jsxs(le,{radius:"md",p:"md",style:{minWidth:0,width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(z,{order:5,mb:"sm",c:o.color,children:o.title}),e.jsx(Ge,{h:"100%",style:{flex:1},children:o.students.length===0?e.jsx(Y,{c:"gray.5",ta:"center",mt:"md",children:"No students"}):o.students.map(s=>e.jsx(ro,{name:s.name,hasCheckbox:o.hasCheckbox,checked:o.checked(s.name),setChecked:t=>o.setChecked(t,s.name)},s.name))})]})}function ro(o){return e.jsx(le,{radius:x(10),p:x(14),mb:x(10),bd:"1.5px solid #e3e6ea",onClick:()=>o.setChecked(!o.checked),children:e.jsxs(N,{justify:"space-between",align:"center",children:[e.jsx(z,{order:5,fw:600,children:o.name}),o.hasCheckbox&&e.jsx(F,{bg:"#fafbfe",checked:o.checked,onChange:s=>o.setChecked(s.currentTarget.checked),color:"blue",size:"md",radius:"md"})]})})}export{So as Route,to as forceReset};
