import{j as e,r as c}from"./index-Cs26fcMD.js";import{a as y}from"./perms-C6iDSZS9.js";import{b as I,u as S,a as v,B as k,c as N,g as l,f as C}from"./fetchBackend-DBt8ilMt.js";import{S as M}from"./SignInButton-DXtwq1jm.js";import{n as O,O as T,B as f}from"./Button-CTNRrkMo.js";import{C as D}from"./Center-BYbNH_cr.js";import{M as P}from"./Modal-qoK3krDT.js";import{T as m}from"./Title-DSJ_a2q4.js";import{T as A}from"./TextInput-Q-qqpYOc.js";import"./tslib.es6-BDktPqig.js";import"./CloseButton-DiS-oS8o.js";import"./Paper-D_IiePsR.js";var h={root:"m_7f854edf"};const B={position:{bottom:0,right:0},zIndex:O("modal"),withinPortal:!0},z=N((o,{zIndex:r,position:t})=>({root:{"--affix-z-index":r?.toString(),"--affix-top":l(t?.top),"--affix-left":l(t?.left),"--affix-bottom":l(t?.bottom),"--affix-right":l(t?.right)}})),u=I((o,r)=>{const t=S("Affix",B,o),{classNames:i,className:d,style:s,styles:n,unstyled:a,vars:p,portalProps:x,zIndex:F,withinPortal:g,position:R,attributes:b,...j}=t,w=v({name:"Affix",classes:h,props:t,className:d,style:s,classNames:i,styles:n,unstyled:a,attributes:b,vars:p,varsResolver:z});return e.jsx(T,{...x,withinPortal:g,children:e.jsx(k,{ref:r,...w("root"),...j})})});u.classes=h;u.displayName="@mantine/core/Affix";function W(o){const[r,t]=c.useState(!1),[i,d]=c.useState(""),s=y({queryKey:["manualCheckIn"],queryFn:async()=>{const n=parseInt(i);if(Number.isNaN(n))return window.alert("Invalid student ID"),!1;const a=await C("/checkin/runManual/",{method:"POST",credentials:"include",body:JSON.stringify({student_id:n})});switch(a.status){case 400:return window.alert("Invalid Student ID."),null;case 401:return window.alert("Dev error: insufficient perms(bruH)"),null;case 405:return window.alert("There are no free blocks to sign in to."),null;case 200:return(await a.json()).studentName;default:return window.alert("LMAO unknown error: "+a.status),null}},enabled:!1});return e.jsxs(e.Fragment,{children:[e.jsx(u,{bottom:200,w:"100%",display:o.perms?.teacherMonitored?void 0:"none",children:e.jsx(D,{children:e.jsx(f,{bg:"red",size:"lg",onClick:()=>t(!0),children:"Don't have a phone?"})})}),e.jsx(P,{opened:r,onClose:()=>t(!1),children:s.data?e.jsxs(e.Fragment,{children:[e.jsxs(m,{mb:30,children:["Thanks for signing in, ",s.data,"!"]}),e.jsx(f,{onClick:()=>t(!1),children:"Ok"})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{mb:30,children:"Sign in manually"}),e.jsxs("form",{onSubmit:()=>s.refetch(),children:[e.jsx(A,{value:i,onChange:n=>d(n.target.value),placeholder:"Student ID(The numbers on your ID card)",size:"lg",radius:12,mb:20}),e.jsx(M,{submitting:s.isFetching})]})]})})]})}export{W as default};
